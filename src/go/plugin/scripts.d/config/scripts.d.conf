# scripts.d.plugin configuration sample.
# Each entry under `jobs:` below describes a configuration shard. A shard can
# define explicit Nagios jobs and/or provision entire directories.

time_periods:
  - name: 24x7
    alias: Always on
    rules:
      - type: weekly
        days: [sunday, monday, tuesday, wednesday, thursday, friday, saturday]
        ranges: ["00:00-24:00"]

logging:
  enabled: true
  otlp:
    endpoint: 127.0.0.1:4317
    tls: false
    timeout: 5s

# Optional tuning for filesystem reload monitoring
watcher_debounce: 250ms
directory_rescan_interval: 1m

jobs:
  - name: local_plugins
    defaults:
      timeout: 60s
      timeout_state: critical
      check_interval: 5m
      retry_interval: 1m
      max_check_attempts: 3
      inter_check_jitter: 5s
      check_period: 24x7
    user_macros:
      USER1: "/usr/lib/nagios/plugins"
      USER2: "/etc/nagios/certs"

    jobs:
      - name: ping_localhost
        plugin: "$USER1$/check_ping"
        args:
          - "-H"
          - "$HOSTADDRESS$"
          - "-w"
          - "$ARG1$"
          - "-c"
          - "$ARG2$"
        arg_values:
          - "100.0,20%"
          - "200.0,40%"
        custom_vars:
          SERVICE_TIER: lab

    directories:
      - name_prefix: stock_
        path: /usr/lib/nagios/plugins
        include:
          - "check_*"
        exclude:
          - "check_nrpe"
        recursive: false
        defaults:
          timeout: 45s
          retry_interval: 30s

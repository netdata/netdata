plugin_name: go.d.plugin
modules:
  - meta:
      id: collector-go.d.plugin-typesense
      plugin_name: go.d.plugin
      module_name: typesense
      monitored_instance:
        name: Typesense
        link: https://typesense.org/
        categories:
          - data-collection.search-engines
        icon_filename: typesense.svg
      related_resources:
        integrations:
          list: []
      alternative_monitored_instances: []
      info_provided_to_referring_integrations:
        description: ""
      keywords:
        - typesense
        - search engine
      most_popular: false
    overview:
      data_collection:
        metrics_description: |
          This collector monitors the overall health status and performance of your Typesense servers.
          It gathers detailed metrics, including the total number of requests processed, the breakdown of different request types, and the average latency experienced by each request.
        method_description: |
          It gathers metrics by periodically issuing HTTP GET requests to the Typesense server:

          - [/health](https://typesense.org/docs/27.0/api/cluster-operations.html#health) endpoint to check server health.
          - [/stats.json](https://typesense.org/docs/27.0/api/cluster-operations.html#api-stats) endpoint to collect data on requests and latency.
      default_behavior:
        auto_detection:
          description: |
            The collector can automatically detect Typesense instances running on:

            - localhost that are listening on port 8108
            - within Docker containers
        limits:
          description: ""
        performance_impact:
          description: ""
      additional_permissions:
        description: ""
      multi_instance: false
      supported_platforms:
        include: []
        exclude: []
    setup:
      prerequisites:
        list:
          - title: API Key Configuration
            description: |
              While optional, configuring an [API key](https://typesense.org/docs/0.20.0/api/api-keys.html#api-keys) is highly recommended to enable the collector to gather [stats metrics](https://typesense.org/docs/27.0/api/cluster-operations.html#api-stats), including request counts and latency.
              Without an API key, the collector will only collect health status information.

              > If you're running Typesense with the API key provided as a command-line parameter (e.g., `--api-key=XYZ`), Netdata can automatically detect and use this key for queries.
              > In this case, no additional configuration is required.
      configuration:
        file:
          name: go.d/typesense.conf
        options:
          description: |
            The following options can be defined globally: update_every, autodetection_retry.
          folding:
            title: Config options
            enabled: true
          list:
            - name: update_every
              description: Data collection interval (seconds).
              default_value: 1
              required: false
              group: Base
            - name: autodetection_retry
              description: Autodetection retry interval (seconds). Set 0 to disable.
              default_value: 0
              required: false
              group: Base
            - name: url
              description: Target endpoint URL.
              default_value: http://127.0.0.1:8108
              required: true
              group: Base
            - name: timeout
              description: HTTP request timeout (seconds).
              default_value: 1
              required: false
              group: Base

            - name: api_key
              description: "Typesense API key (`X-TYPESENSE-API-KEY`). See [API Keys](https://typesense.org/docs/0.20.0/api/api-keys.html#api-keys)."
              default_value: ""
              required: false
              group: HTTP Auth
            - name: username
              description: Username for Basic HTTP authentication.
              default_value: ""
              required: false
              group: HTTP Auth
            - name: password
              description: Password for Basic HTTP authentication.
              default_value: ""
              required: false
              group: HTTP Auth
            - name: bearer_token_file
              description: "Path to a file containing a bearer token (used for `Authorization: Bearer`)."
              default_value: ""
              required: false
              group: HTTP Auth

            - name: tls_skip_verify
              description: Skip TLS certificate and hostname verification (insecure).
              default_value: no
              required: false
              group: TLS
            - name: tls_ca
              description: Path to CA bundle used to validate the server certificate.
              default_value: ""
              required: false
              group: TLS
            - name: tls_cert
              description: Path to client TLS certificate (for mTLS).
              default_value: ""
              required: false
              group: TLS
            - name: tls_key
              description: Path to client TLS private key (for mTLS).
              default_value: ""
              required: false
              group: TLS

            - name: proxy_url
              description: HTTP proxy URL.
              default_value: ""
              required: false
              group: Proxy
            - name: proxy_username
              description: Username for proxy Basic HTTP authentication.
              default_value: ""
              required: false
              group: Proxy
            - name: proxy_password
              description: Password for proxy Basic HTTP authentication.
              default_value: ""
              required: false
              group: Proxy

            - name: method
              description: HTTP method to use.
              default_value: "GET"
              required: false
              group: Request
            - name: body
              description: Request body (e.g., for POST/PUT).
              default_value: ""
              required: false
              group: Request
            - name: headers
              description: "Additional HTTP headers (one per line as key: value)."
              default_value: ""
              required: false
              group: Request
            - name: not_follow_redirects
              description: Do not follow HTTP redirects.
              default_value: no
              required: false
              group: Request
            - name: force_http2
              description: Force HTTP/2 (including h2c over TCP).
              default_value: no
              required: false
              group: Request

            - name: vnode
              description: Associates this data collection job with a [Virtual Node](https://learn.netdata.cloud/docs/netdata-agent/configuration/organize-systems-metrics-and-alerts#virtual-nodes).
              default_value: ""
              required: false
              group: Virtual Node
        examples:
          folding:
            title: Config
            enabled: true
          list:
            - name: Basic
              description: A basic example configuration.
              folding:
                enabled: false
              config: |
                jobs:
                  - name: local
                    url: http://127.0.0.1:8108
                    api_key: XYZ
            - name: Multi-instance
              description: |
                > **Note**: When you define multiple jobs, their names must be unique.

                Collecting metrics from local and remote instances.
              config: |
                jobs:
                  - name: local
                    url: http://127.0.0.1:8108
                    api_key: XYZ

                  - name: remote
                    url: http://192.0.2.1:8108
                    api_key: XYZ
    troubleshooting:
      problems:
        list: []
    alerts: []
    metrics:
      folding:
        title: Metrics
        enabled: false
      description: ""
      availability: []
      scopes:
        - name: global
          description: These metrics refer to the entire monitored application.
          labels: []
          metrics:
            - name: typesense.health_status
              description: Health Status
              unit: status
              chart_type: line
              dimensions:
                - name: ok
                - name: out_of_disk
                - name: out_of_memory
            - name: typesense.total_requests
              description: Total Requests
              unit: requests/s
              chart_type: line
              dimensions:
                - name: requests
            - name: typesense.requests_by_operation
              description: Requests by Operation
              unit: requests/s
              chart_type: line
              dimensions:
                - name: search
                - name: write
                - name: import
                - name: delete
            - name: typesense.latency_by_operation
              description: Latency by Operation
              unit: milliseconds
              chart_type: line
              dimensions:
                - name: search
                - name: write
                - name: import
                - name: delete
            - name: typesense.overloaded_requests
              description: Overloaded Requests
              unit: requests/s
              chart_type: line
              dimensions:
                - name: overloaded

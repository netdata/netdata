# Generic network interfaces abstract profile.
# MIB: IF-MIB

metadata:
  interface:
    fields:
      name:
        symbol:
          OID: 1.3.6.1.2.1.31.1.1.1.1
          name: ifName
        description: Interface name.
      description:
        symbol:
          OID: 1.3.6.1.2.1.2.2.1.2
          name: ifDescr
        description: Interface description.
      mac_address:
        symbol:
          OID: 1.3.6.1.2.1.2.2.1.6
          name: ifPhysAddress
          format: mac_address
        description: Interface MAC address.
      admin_status:
        symbol:
          OID: 1.3.6.1.2.1.2.2.1.7
          name: ifAdminStatus
        description: Interface administrative status.
      oper_status:
        symbol:
          OID: 1.3.6.1.2.1.2.2.1.8
          name: ifOperStatus
        description: Interface operational status.
      # TODO: Impl ip_address
      alias: # from another table
        symbol:
          OID: 1.3.6.1.2.1.31.1.1.1.18
          name: ifAlias
        description: Interface alias.
    id_tags:
      - symbol:
          OID: 1.3.6.1.2.1.31.1.1.1.1
          name: ifName
        tag: interface

metrics:
- MIB: IF-MIB
  symbol:
    OID: 1.3.6.1.2.1.2.1.0
    name: ifNumber
  description: The number of network interfaces.
  unit: '{interface}'

- MIB: IF-MIB
  table:
    OID: 1.3.6.1.2.1.2.2
    name: ifTable
  metric_type: monotonic_count_and_rate
  symbols:
  - OID: 1.3.6.1.2.1.2.2.1.14
    name: ifInErrors
    description: The number of inbound packets that contained errors.
    unit: packet
  - OID: 1.3.6.1.2.1.2.2.1.13
    name: ifInDiscards
    description: The number of inbound packets that were discarded.
    unit: packet
  - OID: 1.3.6.1.2.1.2.2.1.20
    name: ifOutErrors
    description: The number of outbound packets that contained errors.
    unit: packet
  - OID: 1.3.6.1.2.1.2.2.1.19
    name: ifOutDiscards
    description: The number of outbound packets that were discarded.
    unit: packet
  metric_tags:
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.1
      name: ifName
    table: ifXTable
    tag: interface
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.18
      name: ifAlias
    table: ifXTable
    tag: interface_alias
  - index: 1  # ifIndex
    tag: interface_index
- MIB: IF-MIB
  table:
    OID: 1.3.6.1.2.1.2.2
    name: ifTable
  symbols:
  - OID: 1.3.6.1.2.1.2.2.1.7
    name: ifAdminStatus
    description: The desired state of the interface.
    unit: '{interface_status}'
  - OID: 1.3.6.1.2.1.2.2.1.8
    name: ifOperStatus
    description: The current operational state of the interface.
    unit: '{interface_status}'
  - OID: 1.3.6.1.2.1.2.2.1.5
    name: ifSpeed
    description: An estimate of the interface's current bandwidth in bits per second.
    unit: bit/s
  metric_tags:
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.1
      name: ifName
    table: ifXTable
    tag: interface
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.18
      name: ifAlias
    table: ifXTable
    tag: interface_alias
  - index: 1  # ifIndex
    tag: interface_index
- MIB: IF-MIB
  table:
    OID: 1.3.6.1.2.1.31.1.1
    name: ifXTable
  metric_type: monotonic_count
  symbols:
  - OID: 1.3.6.1.2.1.31.1.1.1.7
    name: ifHCInUcastPkts
    description: The number of unicast packets received on the interface.
    unit: packet
  - OID: 1.3.6.1.2.1.31.1.1.1.8
    name: ifHCInMulticastPkts
    description: The number of multicast packets received on the interface.
    unit: packet
  - OID: 1.3.6.1.2.1.31.1.1.1.9
    name: ifHCInBroadcastPkts
    description: The number of broadcast packets received on the interface.
    unit: packet
  - OID: 1.3.6.1.2.1.31.1.1.1.11
    name: ifHCOutUcastPkts
    description: The number of unicast packets transmitted on the interface.
    unit: packet
  - OID: 1.3.6.1.2.1.31.1.1.1.12
    name: ifHCOutMulticastPkts
    description: The number of multicast packets transmitted on the interface.
    unit: packet
  - OID: 1.3.6.1.2.1.31.1.1.1.13
    name: ifHCOutBroadcastPkts
    description: The number of broadcast packets transmitted on the interface.
    unit: packet
  metric_tags:
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.1
      name: ifName
    tag: interface
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.18
      name: ifAlias
    table: ifXTable
    tag: interface_alias
  - index: 1  # ifIndex
    tag: interface_index
- MIB: IF-MIB
  table:
    OID: 1.3.6.1.2.1.31.1.1
    name: ifXTable
  metric_type: monotonic_count_and_rate
  symbols:
  - OID: 1.3.6.1.2.1.31.1.1.1.6
    name: ifHCInOctets
    description: The total number of octets received on the interface, including framing characters.
    unit: byte
  - OID: 1.3.6.1.2.1.31.1.1.1.10
    name: ifHCOutOctets
    description: The total number of octets transmitted out of the interface, including framing characters.
    unit: byte
  metric_tags:
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.1
      name: ifName
    tag: interface
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.18
      name: ifAlias
    table: ifXTable
    tag: interface_alias
  - index: 1  # ifIndex
    tag: interface_index
- MIB: IF-MIB
  table:
    OID: 1.3.6.1.2.1.31.1.1
    name: ifXTable
  symbols:
  - OID: 1.3.6.1.2.1.31.1.1.1.15
    name: ifHighSpeed
    description: The interface's current bandwidth in Mbps.
    unit: Mbit/s
  metric_tags:
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.1
      name: ifName
    tag: interface
  - symbol:
      OID: 1.3.6.1.2.1.31.1.1.1.18
      name: ifAlias
    table: ifXTable
    tag: interface_alias
  - index: 1  # ifIndex
    tag: interface_index
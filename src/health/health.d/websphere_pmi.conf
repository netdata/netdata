# WebSphere PMI health alerts

# JVM CPU utilization
template: websphere_pmi_cpu_utilization
      on: websphere_pmi.cpu_utilization
   class: Utilization
    type: Application Server
component: WebSphere PMI
  lookup: average -5m unaligned of utilization
   units: %
   every: 30s
    warn: $this > 80
    crit: $this > 90
   delay: down 15m multiplier 1.5 max 1h
 summary: WebSphere PMI CPU utilization
    info: PMI-reported CPU utilization is ${value}%
      to: webmaster

# Thread pool saturation
template: websphere_pmi_threadpool_utilization
      on: websphere_pmi.threadpool_usage
   class: Utilization
    type: Application Server
component: WebSphere PMI
    calc: ($size > 0) ? ($active * 100 / $size) : 0
   units: %
   every: 30s
    warn: $this > 85
    crit: $this > 95
   delay: down 15m multiplier 1.5 max 1h
 summary: WebSphere PMI thread pool ${label:name} utilization
    info: Thread pool ${label:name} is using ${value}% of its configured capacity
      to: webmaster

# JDBC pool utilization
template: websphere_pmi_jdbc_pool_utilization
      on: websphere_pmi.jdbc_pool_usage
   class: Utilization
    type: Database
component: WebSphere PMI
  lookup: average -5m unaligned of percent_used
   units: %
   every: 30s
    warn: $this > 80
    crit: $this > 90
   delay: down 15m multiplier 1.5 max 1h
 summary: WebSphere PMI JDBC pool ${label:pool} utilization
    info: JDBC pool ${label:pool} is ${value}% utilized
      to: dba

# JDBC pool wait time
template: websphere_pmi_jdbc_pool_wait_time
      on: websphere_pmi.jdbc_pool_time
   class: Latency
    type: Database
component: WebSphere PMI
  lookup: average -5m unaligned of wait
   units: ms
   every: 30s
    warn: $this > 1000
    crit: $this > 5000
   delay: down 15m multiplier 1.5 max 1h
 summary: WebSphere PMI JDBC pool ${label:pool} wait time
    info: Average wait time in JDBC pool ${label:pool} is ${value}ms
      to: dba

# JMS queue wait time
template: websphere_pmi_jms_queue_wait_time
      on: websphere_pmi.jms_queue_wait_time
   class: Latency
    type: Messaging
component: WebSphere PMI
  lookup: max -5m unaligned of aggregate
   units: ms
   every: 1m
    warn: $this > 2000
    crit: $this > 10000
   delay: down 15m multiplier 1.5 max 1h
 summary: WebSphere PMI JMS queue ${label:destination} wait time
    info: Aggregate JMS wait time for destination ${label:destination} is ${value}ms
      to: webmaster

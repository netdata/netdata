pattern: "(?P<message>.*)"

# Test very long strings and potential buffer overflows

inject:
  - key: LONG_VALUE_1KB
    value: "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
    
  - key: VERY_LONG_KEY_THAT_EXCEEDS_SIXTY_FOUR_CHARACTERS_WHICH_IS_THE_LIMIT_FOR_SYSTEMD_JOURNAL_KEYS
    value: "This key is too long"
    
  - key: REPEATED_PATTERN
    value: "${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}${LINE}"
    
  - key: LONG_MULTI_LINE
    value: |
      This is a very long multi-line value that spans
      many lines and contains lots of text to test how
      the YAML parser handles large multi-line strings.
      It should preserve newlines and spacing exactly.
      Line 5
      Line 6 
      Line 7
      Line 8
      Line 9
      Line 10
      ... (imagine 100 more lines here)
      
rewrite:
  - key: TEST_OVERFLOW
    match: "(.){1000,}"  # Match very long strings
    value: "TRUNCATED: ${1}..."
    
  - key: DEEP_RECURSION
    value: "${KEY1_${KEY2_${KEY3_${KEY4_${KEY5_${KEY6_${KEY7_${KEY8_${KEY9_${KEY10}}}}}}}}}}"
    inject: yes

rename:
  - old_key: "THIS_IS_A_VERY_LONG_OLD_KEY_NAME_THAT_SHOULD_BE_RENAMED_TO_SOMETHING_SHORTER"
    new_key: "SHORT_NAME"
    
  - old_key: "A"
    new_key: "THIS_IS_A_VERY_LONG_NEW_KEY_NAME_THAT_EXCEEDS_THE_SYSTEMD_JOURNAL_LIMIT_OF_64_CHARS"

filter:
  include: ".{0,1000}"     # Permissive pattern
  exclude: ".{1000,}"      # Exclude very long lines
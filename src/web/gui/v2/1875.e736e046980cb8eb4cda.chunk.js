!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e4e97f1f-cb0a-42e2-b102-dd2850088e88",e._sentryDebugIdIdentifier="sentry-dbid-e4e97f1f-cb0a-42e2-b102-dd2850088e88")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"08864407160b3973b9b88c5ae92687282b21e2f4"},(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[1875],{83863:(e,t,n)=>{n.d(t,{Bo:()=>b,Hv:()=>o,Lf:()=>g,Lm:()=>O,NK:()=>D,OK:()=>_,Pm:()=>A,R8:()=>f,Ro:()=>y,WB:()=>c,Ws:()=>N,XG:()=>j,ZE:()=>v,j8:()=>r,jV:()=>l,uZ:()=>h});n(62953);const i={threshold:{label:"Threshold",value:"threshold"},variance:{label:"Variance",value:"variance"},anomalies:{label:"Anomalies",value:"anomalies"}},o=Object.values(i),a=i.threshold.value,l={thresholds:{above:{label:"above",value:"above",symbol:">"},below:{label:"below",value:"below",symbol:"<"}}},r=Object.values(l.thresholds),s=l.thresholds.above,u={seconds:{label:"seconds",value:"seconds",symbol:"s"},minutes:{label:"minutes",value:"minutes",symbol:"m"},hours:{label:"hours",value:"hours",symbol:"h"},days:{label:"days",value:"days",symbol:"d"}},c=Object.values(u),d={"5_min":{label:"5 mins",value:"5_min",after:"-5m"},"10_min":{label:"10 mins",value:"10_min",after:"-10m"},"15_min":{label:"15 mins",value:"15_min",after:"-15m"},"30_min":{label:"30 mins",value:"30_min",after:"-30m"},"1_hour":{label:"1 hour",value:"1_hour",after:"-1h"},"2_hours":{label:"2 hours",value:"2_hours",after:"-2h"},"6_hours":{label:"6 hours",value:"6_hours",after:"-6h"},"12_hours":{label:"12 hours",value:"12_hours",after:"-12h"},"1_day":{label:"1 day",value:"1_day",after:"-1d"},"2_days":{label:"2 days",value:"2_days",after:"-2d"},"7_days":{label:"7 days",value:"7_days",after:"-7d"}},v=Object.values(d),m=d["5_min"],p={linux:{label:"Linux",value:"linux"},freeBSD:{label:"FreeBSD",value:"freeBSD"},windows:{label:"Windows",value:"windows"}},g={label:"".concat(Object.keys(p).length," OS"),value:""},f=[g,...Object.values(p)],h={avg:{label:"AVG()",value:"average"},sum:{label:"SUM()",value:"sum"},min:{label:"MIN()",value:"min"},max:{label:"MAX()",value:"max"},stddev:{label:"STDDEV()",value:"stddev"},cv:{label:"CV()",value:"cv"}},b=Object.values(h),y=h.stddev,D=h.avg,C={sum:{label:"SUM",value:"of"},each:{label:"EACH",value:"foreach"}},O=Object.values(C),w=C.sum,A={unaligned:{label:"unaligned",value:"unaligned"},percentage:{label:"percentage",value:"percentage"},absolute:{label:"absolute",value:"absolute"},min2max:{label:"min2max",value:"min2max"}},N=Object.values(A),_={label:"&this",value:"$this"},j={alertId:null,detection:{method:a},metrics:{on:"",hosts:{items:[],expression:""},os:[],charts:{items:[],expression:""},chartLabels:{items:[],expression:""},lookup:{aggregation:D,denoter:w,dimensions:[],timePeriod:m,options:[]},calc:{active:!1,value:""},units:""},alertingConditions:{denoter:s,critical:{isFormula:!1,denoter:s,value:85,recovery:null},warning:{isFormula:!1,denoter:s,value:75,recovery:null},interval:{value:60,unit:u.seconds},delayNotification:{active:!1,up:{value:0,unit:u.seconds},down:{value:0,unit:u.seconds},multiplier:1,max:{value:0,unit:u.hours}},agentOptions:{active:!1,off:!0,warningAlertsDuration:{value:15,unit:u.minutes},criticalAlertsDuration:{value:5,unit:u.minutes},sendTo:{value:"",clearNotifications:!0},execScript:{active:!1,path:""}}},description:{summary:"",templateName:"",templateDescription:""}}},21875:(e,t,n)=>{n.d(t,{v7:()=>c,vX:()=>u,$h:()=>v,op:()=>h,I8:()=>b,aR:()=>p,BO:()=>f,Vj:()=>m});n(17333),n(98992),n(54520),n(62953);var i=n(96540),o=n(47444),a=n(83863);const l=(0,o.eU)({key:"alertConfiguration",default:a.XG}),r=(0,o.eU)({key:"alertConfigurationChart",default:null});var s=n(59303);const u=()=>(0,o.vc)(r),c=()=>(0,o.L4)(r),d=(0,o.gD)({key:"alertConfigurationSelector",get:e=>{let{get:t}=e;return t(l)},set:(e,t)=>{let{set:n}=e;n(l,(e=>({...e,...t})))}}),v=()=>(0,o.L4)(d),m=()=>(0,o.E0)(l),p=()=>{const[e,t]=v(),{detection:{method:n},metrics:i}=e;return{detectionMethod:n,setDetectionMethod:e=>t({detection:{method:e},metrics:{...i,lookup:{...i.lookup,aggregation:"variance"==e?a.Ro:a.NK}}})}},g=e=>{let{scope:t,setConfiguration:n,metrics:i,isComposite:o}=e;return e=>{const a=null!==e&&void 0!==e&&e.length?e.filter((e=>{let{value:t}=e;return t})):e;n({metrics:{...i,[t]:o||Array.isArray(a)?a:a.value?[a]:[]}})}},f=()=>{const[e,t]=v(),{metrics:n}=e,i=g({scope:"hosts",setConfiguration:t,metrics:n,isComposite:!0}),o=g({scope:"charts",setConfiguration:t,metrics:n,isComposite:!0}),a=g({scope:"chartLabels",setConfiguration:t,metrics:n,isComposite:!0}),l=g({scope:"os",setConfiguration:t,metrics:n});return{metrics:n,setLookup:e=>{let{aggregation:i,denoter:o,dimensions:a,timePeriod:l,options:r}=e;t({metrics:{...n,lookup:{...n.lookup,...i?{aggregation:i}:{},...o?{denoter:o}:{},...a?{dimensions:a}:{},...l?{timePeriod:l}:{},...r?{options:r}:{}}}})},setOn:e=>t({metrics:{...n,on:e}}),setHosts:i,setCharts:o,setChartLabels:a,setOs:l,setCalcActive:e=>t({metrics:{...n,calc:{...n.calc,active:e,...e?{}:{value:""}}}}),setCalcValue:e=>t({metrics:{...n,calc:{...n.calc,value:e}}}),setUnitsValue:e=>t({metrics:{...n,units:e}})}},h=()=>{const[e,t]=v(),{alertId:n,alertingConditions:i}=e,o=!!n,a=e=>n=>t({alertingConditions:{...i,interval:{...i.interval,[e]:n}}}),l=a("value"),r=a("unit"),s=e=>n=>t({alertingConditions:{...i,[e]:{...i[e],active:n}}}),u=s("delayNotification"),c=e=>n=>o=>a=>t({alertingConditions:{...i,[e]:{...i[e],[n]:{...i[e][n],[o]:a}}}}),d=c("delayNotification"),m=d("up"),p=m("value"),g=m("unit"),f=d("down"),h=f("value"),b=f("unit"),y=d("max"),D=y("value"),C=y("unit"),O=s("agentOptions"),w=c("agentOptions"),A=w("warningAlertsDuration"),N=A("value"),_=A("unit"),j=w("criticalAlertsDuration"),x=j("value"),k=j("unit"),I=e=>n=>t({alertingConditions:{...i,agentOptions:{...i.agentOptions,sendTo:{...i.agentOptions.sendTo,[e]:n}}}}),S=I("value"),T=I("clearNotifications"),V=e=>n=>t({alertingConditions:{...i,agentOptions:{...i.agentOptions,execScript:{...i.agentOptions.execScript,[e]:n}}}}),U=V("active"),E=V("path");return{isEdit:o,alertingConditions:i,setMainDenoter:e=>t({alertingConditions:{...i,denoter:e,critical:{...i.critical,denoter:e},warning:{...i.warning,denoter:e}}}),setIntervalValue:l,setIntervalUnit:r,setThreshold:(e,n)=>o=>t({alertingConditions:{...i,[e]:{...i[e],[n]:o}}}),setRecoveryThreshold:(e,n)=>o=>t({alertingConditions:{...i,[e]:{...i[e],recovery:{...i[e].recovery,[n]:o}}}}),setDelayNotificationActive:u,setDelayNotificationUpValue:p,setDelayNotificationUpUnit:g,setDelayNotificationDownValue:h,setDelayNotificationDownUnit:b,setDelayNotificationMaxDelayValue:D,setDelayNotificationMaxDelayUnit:C,setDelayNotificationMultiplier:e=>t({alertingConditions:{...i,delayNotification:{...i.delayNotification,multiplier:e}}}),setAgentOptionsActive:O,setAgentOptionsRepeatNotification:e=>t({alertingConditions:{...i,agentOptions:{...i.agentOptions,off:e}}}),setAgentOptionsWarningAlertsDurationValue:N,setAgentOptionsWarningAlertsDurationUnit:_,setAgentOptionsCriticalAlertsDurationValue:x,setAgentOptionsCriticalAlertsDurationUnit:k,setAgentOptionsSendToValue:S,setAgentOptionsSendToClearNotifications:T,setAgentOptionsExecScriptActive:U,setAgentOptionsExecScriptPath:E}},b=()=>{const[e,t]=v(),{metrics:{on:n},description:{templateName:o,templateDescription:a,summary:l}}=e;return(0,i.useEffect)((()=>{if(n){const{template:i,info:l}=(0,s.q7)({on:n,templateName:o,templateDescription:a});t({description:{...e.description,templateName:i,templateDescription:l}})}}),[n]),{templateName:o,templateDescription:a,summary:l,setTemplateName:n=>t({description:{...e.description,templateName:n}}),setTemplateDescription:n=>t({description:{...e.description,templateDescription:n}}),setSummary:n=>t({description:{...e.description,summary:n}})}}},59303:(e,t,n)=>{n.d(t,{L7:()=>r,m8:()=>a,pU:()=>l,q7:()=>y,sS:()=>A,we:()=>N});n(17333),n(3064),n(41393),n(14905),n(98992),n(54520),n(72577),n(81454),n(8872),n(62953);var i=n(83863),o=n(33829);const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n=>{let{target:{checked:i}}=n;return e(t?!i:i)}},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n=>e(t?!n:n)},r=e=>t=>{let{target:{value:n}}=t;return e(n)},s=function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{alertId:o,alertingConditions:a={}}=n,{critical:l,warning:r}=a;return!!o?{...null!==l&&void 0!==l&&l.value?{crit:l.value}:{},...null!==r&&void 0!==r&&r.value?{warn:r.value}:{}}:l&&r&&null!==(e=l.denoter)&&void 0!==e&&e.value&&void 0!==l.value&&null!==(t=r.denoter)&&void 0!==t&&t.value&&void 0!==r.value?{crit:c({flavour:"critical",formula:i.OK.value,isFormula:l.isFormula,denoter:l.denoter,value:l.value,recovery:l.recovery}),warn:c({flavour:"warning",formula:i.OK.value,isFormula:r.isFormula,denoter:r.denoter,value:r.value,recovery:r.recovery})}:{}},u={critical:"$status == $CRITICAL",warning:"$status >= $WARNING"},c=e=>{let{flavour:t,formula:n=i.OK.value,isFormula:o,denoter:a,value:l,recovery:r}=e;const s=u[t];return o?l:null!==r&&void 0!==r&&r.value&&s?"$this ".concat(null===a||void 0===a?void 0:a.symbol," ((").concat(s,")  ? (").concat(r.value,")) : (").concat(l,")"):"".concat(n," ").concat(null===a||void 0===a?void 0:a.symbol," (").concat(l,")")},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{value:t,unit:n}=e;return"".concat(t).concat(null===n||void 0===n?void 0:n.symbol)},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"value";return function(){let t=arguments.length>1?arguments[1]:void 0;const n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((t=>t[e]));return t?n:n.join(" ")}},m=v(),p=v("label"),g=function(){let{aggregation:e,denoter:t,dimensions:n=[],timePeriod:i,options:o=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;const l=o.map((e=>{let{value:t}=e;return t})).join(" "),r=n.map((e=>{let{value:t}=e;return t})).filter(Boolean),s=r.length?"".concat((null===t||void 0===t?void 0:t.value)||"of"," ").concat(r.join(",")):"foreach"==(null===t||void 0===t?void 0:t.value)?"foreach *":null,u="anomalies"==a?"anomaly-rate":"";return{lookup:[null===e||void 0===e?void 0:e.value,null===i||void 0===i?void 0:i.after,l,s,u].filter(Boolean).join(" ")}},f=function(){let{active:e,up:t,down:n,multiplier:i,max:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e||0==parseInt(null===t||void 0===t?void 0:t.value,10)&&0==parseInt(null===n||void 0===n?void 0:n.value,10))return{};const a=[...parseInt(null===t||void 0===t?void 0:t.value,10)>0?["up ".concat(d(t))]:[],...parseInt(null===n||void 0===n?void 0:n.value,10)>0?["down ".concat(d(n))]:[],...parseFloat(i)>0?["multiplier ".concat(i)]:[],...parseInt(null===o||void 0===o?void 0:o.value,10)>0?["max ".concat(d(o))]:[]];return a.length?{delay:a.join(" ")}:{}},h=function(){let{off:e,warningAlertsDuration:t,criticalAlertsDuration:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=[...e?["off"]:[],...!e&&null!==t&&void 0!==t&&t.value?["warning ".concat(d(t))]:[],...!e&&null!==n&&void 0!==n&&n.value?["critical ".concat(d(n))]:[]];return i.length?{repeat:i.join(" ")}:{}},b=function(){let{active:e,sendTo:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{value:n,clearNotifications:i}=t||{};return{...n?{to:n}:{},...e&&!i?{options:"no-clear-notification"}:{}}},y=e=>{let{templateName:t,templateDescription:n,on:i}=e;const a=(0,o.A)(),l=i?"".concat(i.split(".").join("_"),"_").concat(a):a;return{template:t||l,info:n||"Alert description"}},D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;return function(){var n;let{items:i=[],expression:o=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=null===(n=[t(i),o].join(" "))||void 0===n?void 0:n.trim();return a?{[e]:a}:{}}},C=D("hosts"),O=D("charts",(function(){return p(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],!0).reduce(((e,t)=>{var n;const i=(null===(n=/\.(.*?)@/.exec(t))||void 0===n?void 0:n[1])||t;return e.includes(i)||e.push(i),e}),[]).join(" ")})),w=D("chart labels",(e=>m(e,!0).map((e=>e.split(":").join("="))).join(" "))),A=function(){const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{detection:t,metrics:n={},description:i={},alertingConditions:o={}}=e,{on:a,hosts:l,os:r,charts:u,chartLabels:c,lookup:v,calc:p,units:y}=n,{templateName:D,templateDescription:A,summary:N}=i,{agentOptions:_={},interval:j={},delayNotification:x={}}=o,{execScript:k={},sendTo:I={}}=_;return{...D?{template:D}:{},...a?{on:a}:{},...C(l),...null!==r&&void 0!==r&&r.length?{os:m(r)}:{},...O(u),...w(c),...g(v,null===t||void 0===t?void 0:t.method),...null!==p&&void 0!==p&&p.value?{calc:p.value}:{},...y&&null!==p&&void 0!==p&&p.value?{units:y}:{},...j.value?{every:d(j)}:{},...s(e),..._.active&&k.active&&k.path?{exec:k.path}:{},...A?{info:A}:{},...N?{summary:N}:{},...f(x),..._.active?h(_):{},...b(_)}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return Object.entries(e).reduce(((e,t)=>{let[n,i]=t;return[...e,"".concat(n,": ").concat(i)]}),[]).join("\n")},N=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t,context:n="",calculation:o="",displayName:a="",configInfo:l="",critical:r="",warning:s="",lookupMethod:u="",lookupOptions:c=[],lookupAfter:d,lookupBefore:v,lookupDimensions:m="",summary:p}=e;return{...i.XG,...t?{alertId:t}:{},metrics:{...i.XG.metrics,on:n,lookup:{...i.XG.metrics.lookup,aggregation:Object.values(i.uZ).find((e=>{let{value:t}=e;return t==u})),dimensions:m.split(" ").map((e=>({label:e,value:e}))),options:Object.values(i.Pm).filter((e=>{let{value:t}=e;return c.includes(t)}))}},alertingConditions:{...i.XG.alertingConditions,critical:{value:r},warning:{value:s}},description:{summary:p,templateName:a,templateDescription:l}}}}}]);
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="33e3fdde-441b-441a-adaf-1dbf879677b3",e._sentryDebugIdIdentifier="sentry-dbid-33e3fdde-441b-441a-adaf-1dbf879677b3")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"ed021627f8d20b39f0609a37950c1a1e11c33d03"},(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[324],{80959:function(e,t,n){var a=n(87462),l=n(67294),r=n(22195);t.Z=e=>{let{message:t,title:n,...o}=e;const i=(null===o||void 0===o?void 0:o["data-testid"])||"functionError";return l.createElement(r.Flex,(0,a.Z)({alignItems:"center",column:!0,"data-testid":i,flex:!0,gap:1,justifyContent:"center"},o),l.createElement(r.H3,{"data-testid":"".concat(i,"-title")},n),l.createElement(r.TextBig,{color:"textDescription","data-testid":"".concat(i,"-message")},t))}},34324:function(e,t,n){n.r(t),n.d(t,{default:function(){return an}});var a={};n.r(a),n.d(a,{base:function(){return Ft},table:function(){return Kt}});n(33948);var l=n(67294),r=n(91268),o=n(96929),i=n(3322),c=(n(57640),n(9924),n(60677)),s=n(22195),d=n(54316),u=n(46667),m=n(82351),g=n(29814),f=n(72843),p=n(37518),h=n(87462),v=(n(25387),n(2490),n(72608),n(97945)),x=n(97193),E=n(8144);var y=e=>{let{roomId:t,flavour:n}=e;const a=(e=>{const t="fn"===e;return(0,l.useMemo)((()=>({Live:{head:{label:"Live nodes",textColor:"textLite",iconName:"connectivityStatusLive",hasFn:t},node:{textColor:"text",showFn:t,requireFn:t}},Stale:{head:{label:"Stale nodes",textColor:"textLite",iconName:"connectivityStatusStale"},node:{textColor:"text",disabled:t}},Offline:{head:{label:"Offline nodes",textColor:"textLite",iconName:"connectivityStatusOffline",disabled:t},node:{textColor:"textLite",disabled:t}}})),[e])})(n),r=(e=>{const{aggregations:t}=(0,i.ZQ)({extraKey:e});return(0,l.useMemo)((()=>null!==t&&void 0!==t&&t.node_ids?t.node_ids.buckets.reduce(((e,t)=>({...e,[t.key]:t.hits.doc_count})),{}):null),[t])})(n),o="fn"===n,c=(0,i.CE)({extraKey:n});return l.createElement(E.Z,{title:"Nodes",testIdPrefix:"nodes",baseKey:t,extraKey:n,param:"selectedNodeIds",multi:"feed"===n},l.createElement(x.Z,(0,h.Z)({key:n,baseKey:t,extraKey:n,statusProps:a,background:"mainBackground",itemProps:{padding:[1,1,1,.5],maxLength:30},searchMargin:[0,0,2],height:{max:"300px"},multi:"feed"===n,nodeCounts:r},o&&{useFilteredIds:v.HZ},{currentFn:c})))},b=n(46742);var C=e=>{let{param:t,baseKey:n,extraKey:a,testIdPrefix:r,title:o,items:i=["processes"],multi:c=!1}=e;return i.length?l.createElement(E.Z,{title:o,testIdPrefix:r,baseKey:n,extraKey:a,param:t,multi:c},l.createElement(b.ZP,{param:t,baseKey:n,extraKey:a,testIdPrefix:r,collection:i,multi:c})):null};n(88449),n(59849);var S=(e,t)=>{const{loaded:n,loading:a,columns:r,sortedColumns:o}=(0,i.ZQ)({extraKey:e}),c=(0,l.useRef)([]);return(0,l.useMemo)((()=>(!n||a||(c.current=o.reduce(((e,n)=>r[n].filter?[...e,t(n,r)]:e),[])),c.current)),[n,a])},k=n(95248),T=(n(64211),n(41874),n(4480));const w={query:(e,t,n)=>{let{columnVisibility:a}=n;const l=(null===t||void 0===t?void 0:t.toLowerCase())||"";return Object.entries(e).some((e=>{let[t,n]=e;return!!a[t]&&(null!==n&&"undefined"!==typeof n&&(Array.isArray(n)?n.some((e=>String(e).toLowerCase().includes(l))):("object"===typeof n&&Object.keys(n).some((e=>String(n[e]).toLowerCase().includes(l))),String(n).toLowerCase().includes(l))))}))}},I=e=>(t,n)=>!e.some((e=>{let[a,l]=e;return w[a]?!w[a](t,l,n):!(e=>(t,n,a)=>{var l;if("range"===(null===(l=a.columns[e])||void 0===l?void 0:l.filter)&&null!==n&&void 0!==n&&n.length)return t[e]>=n[0]&&t[e]<=n[1];if(!Array.isArray(n)||!n.length)return!0;let r=t[e];return"number"===typeof r?(r=parseFloat(r),n.some((e=>parseFloat(e)===r))):n.includes(r)})(a)(t,l,n)})),K=(0,T.CG)({key:"fnDataFiltered",get:e=>{let{extraKey:t,roomId:n,omit:a=[],keepAll:l,fn:r}=e;return e=>{var o;let{get:c}=e;const s=null===(o=c((0,k.dz)({key:n,extraKey:"".concat(r,"Settings")})))||void 0===o?void 0:o.sortColumn,d=c((0,k.dz)({key:n,extraKey:t})),u=Object.keys(d).reduce(((e,t)=>(a.includes(t)||e.push([t,d[t]]),e)),[]),{columnVisibility:m,data:g,columns:f}=c((0,i.tD)({id:r}));if("feed"===r||!u.length||!g)return g||[];const p=I(u);return l?g.map((e=>p(e,{columnVisibility:m,columns:f,sortColumn:s})?e:{...e,hidden:!0})):g.filter((e=>p(e,{columnVisibility:m,columns:f,sortColumn:s})))}},cachePolicy_UNSTABLE:{eviction:"most-recent"}}),F=function(){let{extraKey:e="fn",omit:t=[],keepAll:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=(0,i.CE)({extraKey:e}),l=(0,p.UL)();return(0,T.sJ)(K({extraKey:"".concat(a||e,"Filters"),fn:a,roomId:l,omit:t,keepAll:n}))};var Z=n(6557);const z=e=>e.id,N={string:(e,t)=>e.localeCompare(t,void 0,{sensitivity:"accent"}),integer:(e,t)=>e-t};var L={table:function(e){let{param:t,columns:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.entries(e.reduce(((e,a)=>{var l,r;return e[a[t]]={count:((null===(l=e[a[t]])||void 0===l?void 0:l.count)||0)+(a.hidden?0:1),type:null===(r=n[t])||void 0===r?void 0:r.type},e}),{})).map((e=>{let[t,{type:n,count:a}]=e;return{id:t,type:n,count:a}})).sort(((e,t)=>(N[e.type]||N.integer)(e.id,t.id)))},default:n.n(Z)()};const D=(e,t)=>({key:e,type:t[e].filter}),A={multiselect:e=>{let{param:t,baseKey:n,extraKey:a,filtersKey:r,testIdPrefix:o,title:c}=e;const s=(e=>{let{extraKey:t,filtersKey:n,param:a}=e;const r=F({extraKey:t,omit:[a],keepAll:!0}),o=(0,k.tk)(a,{extraKey:n}),c=(0,i.ZQ)({key:"type",extraKey:t}),s=L[c]||L.default,d=(0,i.ZQ)({key:"columns",extraKey:t});return(0,l.useMemo)((()=>s(r,{param:a,columns:d})),[a,r,o])})({param:t,extraKey:a,filtersKey:r});return s&&s.length?l.createElement(E.Z,{title:c,testIdPrefix:o,baseKey:n,extraKey:r,param:t,defaultIsOpen:!1},l.createElement(b.ZP,{param:t,baseKey:n,extraKey:r,testIdPrefix:o,collection:s,capitalized:!1,getValue:z,getLabel:z})):null},range:e=>{let{param:t,baseKey:n,extraKey:a,filtersKey:r,testIdPrefix:o,title:c}=e;const{columns:d}=(0,i.ZQ)({extraKey:a}),[u,m]=(0,k.I0)(t,{defaultValue:[],key:n,extraKey:r});if(!d[t])return null;const g=1*d[t].range.min,f=1*d[t].range.max;return l.createElement(E.Z,{title:c,testIdPrefix:o,baseKey:n,extraKey:r,param:t,defaultIsOpen:!1},l.createElement(s.Box,{padding:[2,0],width:"100%"},l.createElement(s.MultiRangeInput,{min:g,max:f,onChange:e=>{let{min:t,max:n}=e;return m([t,n])},initMin:u[0]?1*u[0]:g,initMax:u[1]?1*u[1]:f})))}};var M=e=>{let{roomId:t,extraKey:n}=e;const a=(0,i.CE)({extraKey:n}),r=(e=>S(e,D))(n);return r.map((e=>{const r=A[e.type]||A.multiselect;return l.createElement(r,{key:e.key,title:e.key,testIdPrefix:"function",baseKey:t,extraKey:n,filtersKey:"".concat(a||n,"Filters"),param:e.key})}))};const R=e=>e.name||e.id,P=e=>e.id,O=e=>{let{title:t,options:n,param:a,baseKey:r,filtersKey:o,testIdPrefix:i}=e;return null!==n&&void 0!==n&&n.length?l.createElement(E.Z,{title:t,testIdPrefix:i,baseKey:r,extraKey:o,param:a,defaultIsOpen:!1},l.createElement(b.ZP,{param:a,baseKey:r,extraKey:o,testIdPrefix:i,collection:n,capitalized:!1,getValue:P,getLabel:R})):null},_={nodes:!0};var B=e=>{let{roomId:t,extraKey:n}=e;const a=(0,i.CE)({extraKey:n}),r=(0,i.Cf)(n);return r.length?r.map((e=>_[e.id]?null:l.createElement(O,{key:e.id,title:e.name,options:e.options,param:e.id,testIdPrefix:"function",baseKey:t,filtersKey:"".concat(a||n,"Filters")}))):null};var V=(0,l.memo)((e=>{let{flavour:t,refetch:n,availableFns:a}=e;const r=(0,p.UL)(),{loaded:o,aggregations:c,error:d}=(0,i.ZQ)({extraKey:t});return l.createElement(s.Flex,{column:!0,overflow:{vertical:"auto"},padding:[0,3,30]},"fn"===t&&l.createElement(C,{title:"Function",testIdPrefix:"function",baseKey:r,extraKey:t,param:"selected",items:a}),l.createElement(y,{roomId:r,flavour:t}),o&&!c&&!d&&l.createElement(M,{roomId:r,extraKey:t}),o&&c&&!d&&l.createElement(B,{roomId:r,extraKey:t,onFilter:n}))})),j=(n(15581),n(34514),n(32586)),U=n(76184),H=n(52428);const W=e=>{let{data:t}=e;return l.createElement(U.Z,{name:"Files"},l.createElement(s.Flex,{gap:1,padding:[0,1],alignItems:"center"},l.createElement(s.Box,{sx:{fontWeight:"500",letterSpacing:"1px"},as:s.Text,color:"textLite"},"{;}"),l.createElement(s.TextSmall,null,"Copy data as"),l.createElement(s.Flex,{cursor:"pointer",gap:1,onClick:(0,H.JG)(JSON.stringify(t),{text:"JSON copied to clipboard"})},l.createElement(s.TextSmall,{color:"primary"},"json"),l.createElement(s.Icon,{color:"primary",size:"small",name:"copy"}))))},Q=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return Object.entries(e).reduce(((e,t)=>{let[a,l]=t;const r=n?"".concat(n,".").concat(a):a,o=Array.isArray(l),i=o&&"object"===typeof l[0]&&null!==l[0];return!l||"object"!==typeof l||o&&!i?[...e,[r,o?l.length>1?"[".concat(l.join(", "),"]"):l[0]:l]]:Q(i?(e=>e.reduce(((e,t)=>(Object.entries(t).forEach((t=>{let[n,a]=t;e[n]=[...e[n]||[],a]})),e)),{}))(l):l,e,r)}),t)};var q=e=>{let{selectedRowData:t={},setSelectedRowData:n,...a}=e;const r=(0,l.useMemo)((()=>Q(t).sort(((e,t)=>{let[n]=e,[a]=t;return n.localeCompare(a)}))),[t]);return l.createElement(s.Flex,(0,h.Z)({column:!0,gap:2,overflow:{vertical:"auto"},padding:[2,3]},a),l.createElement(s.Flex,{justifyContent:"between",padding:[2,0],border:{side:"bottom",color:"borderSecondary"}},l.createElement(s.TextBig,{strong:!0},"Row info"),r.length>0&&l.createElement(s.Box,{onClick:()=>n(),cursor:"pointer"},l.createElement(s.TextSmall,{color:"primary"},"Clear selection"))),Array.isArray(r)&&r.length?l.createElement(l.Fragment,null,r.map((e=>{let[t,n]=e;return l.createElement(j.Z,{key:t,size:"small",name:t,testId:"rightBar-rowInfoContent-".concat(t),padding:[1,0,0]},n)})),l.createElement(W,{data:t})):l.createElement(s.Text,null,"Select a row to see raw data"))};const G={color:{active:"success",notActive:"textLite"}},X={filters:{iconName:"filterList",...G,width:"19px",Content:V,dataTestId:"fnFilters",label:"Filters"},info:{iconName:"information",...G,width:"19px",dataTestId:"info",Content:q,label:"Info"}},J=Object.keys(X),Y=(0,c.default)(s.Tabs).withConfig({displayName:"sidebar__StyledTabs",componentId:"sc-1x1ez62-0"})(["overflow:hidden;height:100%;"]),$=e=>{let{isActive:t,color:n,name:a,label:r}=e;return l.createElement(m.Z,{plain:!0,content:r},l.createElement(s.Icon,{name:a,color:t?n.active:n.notActive,height:"18px",width:"18px"}))};var ee=e=>{const[t,n]=(0,u.Z)(!0),[a,r]=(0,l.useState)(0);return(0,l.useEffect)((()=>{e.selectedRowData&&r(1)}),[e.selectedRowData]),l.createElement(d.ZP,{collapsedComponent:l.createElement(g.Z,{availableTabs:X,onClickTab:n,tabsToShow:J}),header:l.createElement(f.Z,{icon:"filterList",isOpen:t,onToggle:n,title:"Filters"}),isOpen:t},l.createElement(s.Flex,{"data-testid":"overview-info",column:!0,overflow:"hidden",height:"100%"},l.createElement(Y,{selected:a,onChange:r,noDefaultBorder:!0},J.map(((t,n)=>{const{iconName:r,color:o,Content:i,dataTestId:c,label:d}=X[t];return l.createElement(s.Tab,{style:{display:1===J.length?"none":"inherit"},"data-testid":c,maxWidth:"100%",key:r,small:!0,label:l.createElement($,{isActive:a===n,name:r,color:o,label:d})},l.createElement(s.Flex,{column:!0,overflow:"hidden",height:"calc(100% - 60px)",position:"relative"},l.createElement(i,e)))})))))},te=n(36560),ne=n(78266),ae=n(89250),le=e=>{const t=(0,k.XT)(e),{state:n}=(0,ae.TH)();return(0,l.useEffect)((()=>{null!==n&&void 0!==n&&n.nodeId&&t([n.nodeId])}),[]),null===n||void 0===n?void 0:n.nodeId},re=n(91008),oe=n(80959);var ie=e=>{let{paramsKey:t,...n}=e;const a=(null===n||void 0===n?void 0:n["data-testid"])||"capableNodesError",r=(0,k.c6)(t),o=(0,v.bV)(null===r||void 0===r?void 0:r[0],"name");return l.createElement(s.Flex,(0,h.Z)({alignItems:"center",flex:!0,gap:8,justifyContent:"center"},n,{"data-testid":a}),l.createElement(s.Icon,{"data-testid":"".concat(a,"-icon"),height:"230px",name:"unreachableNode",width:"230px"}),l.createElement(oe.Z,{"data-testid":"".concat(a,"-details"),gap:2,title:o?"".concat(o," is not configured for Functions"):"Your nodes are not configured for Functions",message:l.createElement(l.Fragment,null,"Learn how to configure your nodes"," ",l.createElement(re.Z,{Component:s.TextBig,"data-ga":"functions-capable-nodes-error::click-docs-link::functions-view","data-testid":"".concat(a,"-docsLink"),href:"https://learn.netdata.cloud/docs/nightly/operations/run-time-troubleshooting-with-functions#prerequisites",target:"_blank",rel:"noopener noreferrer"},"to support functions")),width:{max:"fit-content"}}))},ce=n(36657),se=n(91128),de=n(62554);const ue=(0,c.default)(s.Flex).attrs({alignItems:"center",border:{side:"bottom",color:"borderSecondary"},padding:[2]}).withConfig({displayName:"styled__MenuItem",componentId:"sc-fmyuo7-0"})(["&:last-child{border:none;}"]),me=(0,c.default)(s.TextInput).withConfig({displayName:"styled__TextInput",componentId:"sc-fmyuo7-1"})(['margin:0 10px;min-width:unset;width:45px;> div{margin:0;}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}input[type="number"]{-moz-appearance:textfield;}']);var ge=e=>{let{onClose:t,targetRef:n,paramsKey:a,...r}=e;const o=(null===r||void 0===r?void 0:r["data-testid"])||"refreshOptions",c=(0,i.ZQ)({key:"updateEvery",...a}),[d,m]=(0,i.WO)(a),[g,f]=(0,u.Z)(d);(0,de.Z)((()=>{!!d!==!!g&&m(g)}),200,[d,g]);const[p,h]=(0,i.FF)({...a,defaultValue:c}),[v,x]=(0,l.useState)(p);return(0,de.Z)((()=>{p!==v&&h(v)}),400,[p,v]),n.current?l.createElement(s.Drop,{align:{top:"bottom",right:"right"},animation:!0,background:"dropdown",close:t,column:!0,"data-testid":o,margin:[.5,0,0],onClickOutside:t,onEsc:t,round:1,target:n.current,width:58},l.createElement(ue,{"data-testid":"".concat(o,"-autoRefresh"),justifyContent:"between"},l.createElement(s.Text,{color:"menuItem","data-testid":"".concat(o,"-autoRefresh-label")},"Auto Refresh"),l.createElement(s.Toggle,{colored:!0,checked:g,"data-ga":"functions-refresh-options::auto-refresh-switch::functions-view::".concat(g?"enabled":"disabled"),"data-testid":"".concat(o,"-autoRefresh-switch"),onChange:f})),l.createElement(ue,{"data-testid":"".concat(o,"-pollingInterval")},l.createElement(s.Text,{color:"menuItem","data-testid":"".concat(o,"-pollingInterval-label")},"Refresh every"),l.createElement(me,{"data-ga":"functions-refresh-options::polling-interval::functions-view","data-testid":"".concat(o,"-pollingInterval-input"),min:1,onChange:e=>{let{target:t}=e;const n=+t.value;n>0&&x(n)},size:"tiny",type:"number",value:v}),l.createElement(s.Text,{color:"menuItem","data-testid":"".concat(o,"-pollingInterval-units")},"seconds"))):null},fe=n(89405);var pe=e=>{let{paramsKey:t}=e;const{updatedAt:n}=(0,i.ZQ)(t),{localeTimeString:a,localeDateString:r}=(0,fe.rA)();return l.createElement(s.TextMicro,{color:"textLite"},"Last updated: ",r(n,{long:!0})," ",a(n,{secs:!0}))};const he=c.default.div.withConfig({displayName:"reload__IconsContainer",componentId:"sc-1nbamjz-0"})(["position:relative;"]),ve=(0,c.default)(s.Icon).withConfig({displayName:"reload__SmallIcon",componentId:"sc-1nbamjz-1"})(["position:absolute;top:3px;left:3px;"]);var xe=e=>{let{onRefresh:t,dataGa:n,testId:a,paramsKey:r}=e;const o=(0,i.T2)(r);return l.createElement(he,null,l.createElement(ve,{name:o?"playSolid":"pauseSolid",width:"8px",height:"8px",color:o?"primary":"text"}),l.createElement(s.IconButton,{"data-testid":"".concat(a,"-refreshNowBtn"),"data-ga":"".concat(n,"::click-refresh-now::functions-view"),flavour:"hollow",icon:"refresh",onClick:()=>t({merge:!1}),disabled:o}))};const Ee={fn:{dataGa:"functions-header",hasAutoRefresh:!0,Title:e=>{let{name:t,fn:n="Processes"}=e;return t?"".concat(n," on ").concat(t):n},TextContent:e=>{let{testId:t}=e;return l.createElement(l.Fragment,null,"Netdata Functions enable detailed low-level monitoring at the edge. Use this tab to execute functions on your node and see the results immediately."," ",l.createElement(re.Z,{Component:s.Text,"data-ga":"functions-header::click-docs-link::functions-view","data-testid":"".concat(t,"-docsLink"),href:"https://learn.netdata.cloud/docs/nightly/concepts/netdata-functions",target:"_blank",rel:"noopener noreferrer"},"Read the Netdata functions documentation to learn more"),".")}},feed:{dataGa:"feed-header",Title:()=>"Events",TextContent:e=>{let{testId:t}=e;return l.createElement(l.Fragment,null,"Troubleshoot faster with Netdata Events. Access topology and alert events across the war room in one convenient location."," ",l.createElement(re.Z,{Component:s.Text,"data-ga":"feed-header::click-docs-link::feed-view","data-testid":"".concat(t,"-docsLink"),href:"https://learn.netdata.cloud/docs/nightly/concepts/events-feed",target:"_blank",rel:"noopener noreferrer"},"Read the Events feed documentation to learn more"),".")}}};var ye=(0,l.memo)((e=>{let{onRefresh:t,paramsKey:n,...a}=e;const r=(null===a||void 0===a?void 0:a["data-testid"])||"functionsHeader",o=(0,l.useRef)(),{dataGa:c,hasAutoRefresh:d,TextContent:m,Title:g}=Ee[n.extraKey],[f,p,,h]=(0,u.Z)(!1),x=(0,k.c6)(n),E=(0,v.bV)(null===x||void 0===x?void 0:x[0],"name"),{loaded:y,data:b,totalSize:C}=(0,i.ZQ)(n),S=(0,i.CE)(n);return l.createElement(s.Flex,{"data-testid":r,justifyContent:"between",margin:[0,0,3]},l.createElement(s.Flex,{column:!0,gap:2,"data-testid":"".concat(r,"-info"),width:{max:164}},l.createElement(s.Flex,{gap:2,alignItems:"baseline"},l.createElement(s.H1,{"data-testid":"".concat(r,"-title")},l.createElement(g,{name:E,fn:S})),y&&l.createElement(s.TextSmall,{color:"textLite",strong:!0},"(",C||(null===b||void 0===b?void 0:b.length)||0," results)")),l.createElement(s.Flex,{column:!0,gap:2},l.createElement(s.Text,{"data-testid":"".concat(r,"-description"),color:"textLite"},l.createElement(m,{testId:r})))),l.createElement(s.Flex,{alignItems:"end",column:!0,gap:1},l.createElement(s.Flex,{gap:1},l.createElement(xe,{testId:r,dataGa:c,onRefresh:t,paramsKey:n}),d&&l.createElement(s.IconButton,{"data-testid":"".concat(r,"-refreshOptionsBtn"),"data-ga":"".concat(c,"::click-refresh-options::functions-view"),flavour:"hollow",icon:"chevron_down",ref:o,onClick:p}),f&&l.createElement(ge,{"data-testid":"".concat(r,"-refreshOptions"),isOpen:f,onClose:h,targetRef:o,paramsKey:n})),l.createElement(pe,{paramsKey:n})))}),((e,t)=>e.onRefresh===t.onRefresh)),be=n(41331),Ce=n(78150);const Se=(0,c.default)(s.Icon).attrs({color:"text",height:"16px",width:"16px"}).withConfig({displayName:"value__Arrow",componentId:"sc-1ahoh2y-0"})(["rotate:",";transition:all 200ms ease;"],(e=>{let{rotate:t}=e;return t})),ke=function(e){let{transform:t,decimalPoints:n=0,units:a,defaultValue:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=(0,Ce.Ol)();return(0,l.useMemo)((()=>{switch(t){case"number":return(0,Ce.Jw)(e,{decimalPoints:n,units:a,defaultValue:r});case"duration":return(0,Ce.kl)(e,{defaultValue:r});case"datetime":return o(e,{defaultValue:r});default:return null===e?r:e}}),[e,a])},Te=e=>{let{description:t="",value:n,units:a=""}=e;return t?l.createElement(s.Flex,{column:!0,gap:1,justifyContent:"center"},l.createElement(s.TextSmall,{color:"bright"},t),l.createElement(s.TextSmall,{strong:!0,color:"bright",textAlign:"center"},n," ",a)):"".concat(n," ").concat(a)},we=(0,l.forwardRef)(((e,t)=>{let{icon:n,iconRotate:a,children:r,onClick:o,strong:i,testId:c="cell",textAlign:d,...u}=e;return l.createElement(s.Flex,(0,h.Z)({cursor:o?"pointer":"inherit",gap:.5,onClick:o,overflow:"hidden",ref:t,width:{max:"100%"}},u),n&&l.createElement(Se,{name:n,rotate:a}),l.createElement(s.TextSmall,{"data-testid":"".concat(c,"-value"),strong:i,textAlign:d,truncate:!0,whiteSpace:"nowrap"},r))}));var Ie=e=>{let{description:t="",tooltipValue:n,value:a,valueOptions:r={},...o}=e;const i=ke(a,r);return l.createElement(m.Z,(0,h.Z)({content:l.createElement(Te,{description:t,value:n||a,units:r.units}),"data-testid":"tableCell",isBasic:!0},o),l.createElement(we,null,i))};var Ke=e=>{let{description:t="",maxValue:n,strong:a,type:r,value:o,valueOptions:i={},...c}=e;const d=100*o/n,u="bar"===r,g=(null===c||void 0===c?void 0:c["data-testid"])||"progressTableCell",f=ke(o,i);return l.createElement(m.Z,{content:l.createElement(Te,{description:t,value:o,units:i.units}),isBasic:!0,stretch:"align"},l.createElement(s.Flex,{column:!0,"data-testid":g,gap:1},!u&&l.createElement(we,{strong:a,testid:g},f),l.createElement(s.ProgressBar,{background:"sideBarMini",border:"none",color:["green","netdata"],containerWidth:"100%","data-testid":"".concat(g,"-bar"),height:2,width:"".concat(d,"%")})))};var Fe=e=>{let{value:t,...n}=e;return t=Array.isArray(t)?t:[t],l.createElement(s.Flex,{alignItems:"center",gap:1},t.map(((e,t)=>l.createElement(s.Flex,(0,h.Z)({"data-testid":"tableCell",key:"".concat(e,"-").concat(t)},n),l.createElement(s.Pill,{flavour:"neutral",color:"neutralPillColor",size:"small"},e)))))},Ze=n(74059),ze=n(20686);const Ne=e=>{let{hide:t,user:n}=e;return t||!n?null:l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"by"),l.createElement(Le,null,n))},Le=e=>{let{color:t="textDescription",...n}=e;return l.createElement(s.TextSmall,(0,h.Z)({color:t,strong:!0},n))},De=e=>{let{type:t,text:n=t,hollow:a}=e;const r=a?"".concat(t.toLowerCase(),"AlertsTable"):t.toLowerCase();return l.createElement(ze.Z,(0,h.Z)({type:r},a&&{border:!1}),n)},Ae=(0,c.default)(s.Flex).attrs({gap:1,flexWrap:!0,alignItems:"center"}).withConfig({displayName:"components__Container",componentId:"sc-1qr6qv2-0"})([""]);var Me=n(79655);const Re={CLEAR:0,WARNING:1,CRITICAL:2,UNINITIALIZED:3,UNDEFINED:4},Pe=e=>{let{chart:t,nodeId:n,nodeName:a,spaceSlug:r,roomSlug:o,alert:i}=e;const c=(0,ae.s0)(),d=(0,v.m3)(n),u=(0,l.useCallback)((()=>{i?c(d,{state:{alertId:null===i||void 0===i?void 0:i.id}}):c(d)}),[d,i]),g="/spaces/".concat(r,"/rooms/").concat(o,"/alerts/").concat(null===i||void 0===i?void 0:i.id),{current:f,name:p,previous:h}=i;if("ERROR"===f.status)return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"For the alert"),l.createElement(re.Z,{Component:Le,as:Me.rU,to:g},p),l.createElement(s.TextSmall,null,"for"),l.createElement(re.Z,{Component:Le,as:Me.rU,onClick:u},t.name),l.createElement(s.TextSmall,null,"on"),l.createElement(re.Z,{Component:Le,as:Me.rU,onClick:u},a),l.createElement(s.TextSmall,null,"we couldn't calculate the current value"),l.createElement(m.Z,{align:"bottom",content:"Please check your alert configuration"},l.createElement(s.Icon,{color:"nodeBadgeColor",size:"small",name:"information"})));if("REMOVED"===f.status)return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Alert"),l.createElement(re.Z,{Component:Le,as:Me.rU,to:g},p),l.createElement(s.TextSmall,null,"for"),l.createElement(re.Z,{Component:Le,as:Me.rU,onClick:u},t.name),l.createElement(s.TextSmall,null,"on"),l.createElement(re.Z,{Component:Le,as:Me.rU,onClick:u},a),l.createElement(s.TextSmall,null,"is no longer available, state can't be assessed"));const x=Re[f.status]===Re.CLEAR;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Alert"),l.createElement(re.Z,{Component:Le,as:Me.rU,to:g},p),l.createElement(s.TextSmall,null,"for"),l.createElement(re.Z,{Component:Le,as:Me.rU,onClick:u},t.name),l.createElement(s.TextSmall,null,"on"),l.createElement(re.Z,{Component:Le,as:Me.rU,onClick:u},a),x?l.createElement(s.TextSmall,null,"recovered"):l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,Re[h.status]===Re.CRITICAL?"was demoted":Re[h.status]===Re.WARNING?"escalated":Re[f.status]===Re.UNDEFINED?"transitioned":"was raised"),l.createElement(s.TextSmall,null,"to"),l.createElement(De,{type:f.status}),Re[f.status]===Re.UNDEFINED&&l.createElement(s.TextSmall,null,"state")),l.createElement(s.TextSmall,null,"with value"),l.createElement(De,{type:f.status,text:f.value_string,hollow:!0,padding:[0]}))};const Oe=e=>{let{id:t,name:n}=e;const a=(0,Ze.uk)(),r=(0,p.tE)(t,"slug"),o="/spaces/".concat(a,"/rooms/").concat(r,"/home");return l.createElement(re.Z,{Component:Le,as:Me.rU,to:o},n)},_e=e=>{let{rooms:t}=e;return t.map(((e,n)=>l.createElement(l.Fragment,{key:e.id},n>0&&(n<t.length-1?", ":" and "),l.createElement(Oe,e))))};var Be=e=>{let{rooms:t}=e;if(!t.length)return null;const n=t.length>1?"rooms":"room";return l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"on ",n),l.createElement(_e,{rooms:t}))};const Ve=e=>{let{contexts:t}=e;t.map(((e,n)=>l.createElement(l.Fragment,{key:e},n>0&&(n<t.length-1?", ":" and "),l.createElement(Le,null,e))))};var je=e=>{let{contexts:t}=e;if(!t.length)return null;const n=t.length>1?"contexts":"context";return l.createElement(s.TextSmall,null,"on ",n," ",l.createElement(Ve,{contexts:t}))};const Ue={month:"2-digit",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",long:!1,dateStyle:void 0};var He=e=>{let{start:t,end:n}=e;const{localeDateString:a}=(0,fe.rA)();if(!t||!n)return null;const r=a(new Date(t),Ue),o=a(new Date(n),Ue);return l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"(scheduled ",r," - ",o,")"))};const We={"silencing-rule-created":"created","silencing-rule-deleted":"deleted","silencing-rule-changed":"changed"},Qe=e=>{let{rooms:t=[],contexts:n=[]}=e;return t.length||n.length?l.createElement(l.Fragment,null,!!t.length&&l.createElement(Be,{rooms:t}),!!t.length&&!!n.length&&l.createElement(s.TextSmall,null,"and ",l.createElement(je,{contexts:n}))):null};var qe=e=>{var t;let{action:n,notification:a,user:r,room:o,context:i}=e;const c=((null===a||void 0===a||null===(t=a.silencing)||void 0===t?void 0:t.rule)||[])[0],d=null===r||void 0===r?void 0:r.name,u=(null===i||void 0===i?void 0:i.name)||[];return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Silencing rule"),l.createElement(Le,null,c.name),l.createElement(Qe,{rooms:o,contexts:u}),l.createElement(s.TextSmall,null,"was ",We[n]),l.createElement(Ne,{user:d}),l.createElement(He,c))},Ge=n(62200);const Xe=(e,t)=>{var n,a;return(null===(n=e.target)||void 0===n?void 0:n[t])||(null===(a=e.target)||void 0===a?void 0:a.id)||e[t]||e.id},Je=e=>Array.isArray(e)?e[0].name||e[0].id:e.name||e.id;var Ye=e=>{let{statistics:t}=e;const{live:n,stale:a,removed:r,total:o}=(null===t||void 0===t?void 0:t.nodes)||{};return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Space statistics. Nodes:"),l.createElement(s.TextSmall,{color:Ge.WV.live.statusTextSmallColor},n," live"),l.createElement(s.TextSmall,null,","),l.createElement(s.TextSmall,{color:Ge.WV.stale.statusTextSmallColor},a," stale"),l.createElement(s.TextSmall,null,","),l.createElement(s.TextSmall,{color:Ge.WV.offline.statusTextSmallColor},r," removed"),l.createElement(s.TextSmall,null,","),l.createElement(s.TextSmall,{strong:!0},o," total"))},$e=(n(69810),n(86035),n(6973));const et=e=>{let{stateColor:t,state:n}=e;return l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"became"),l.createElement(Le,{color:t},n))},tt=e=>{let{stateColor:t,state:n}=e;return l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"was"),l.createElement(Le,{color:t},n))},nt={"node-created":et,"node-state-live":et,"node-state-stale":et,"node-state-offline":et,"node-removed":tt,"node-deleted":tt,"node-restored":tt,default:tt};var at=e=>{var t;let{action:n,hosts:a=[]}=e;const{id:r,name:o}=a[0],i=(0,ae.s0)(),c=(0,v.m3)(r),d=(0,l.useCallback)((()=>i(c)),[c]),u=nt[n],m=n.split("-").at(-1),g=null===(t=$e.B[m])||void 0===t?void 0:t.statusTextSmallColor;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Node"),l.createElement(re.Z,{Component:Le,as:Me.rU,onClick:d},o),l.createElement(u,{stateColor:g,state:m}))};const lt=e=>{let{room:t}=e;const n=(0,p.Hm)("untouchable");return l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"was added to",n?" room":""),l.createElement(Le,null,n?Je(t):"this room"))},rt=e=>{let{room:t}=e;const n=(0,p.Hm)("untouchable");return l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"was removed from",n?" room":""),l.createElement(Le,null,n?Je(t):"this room"))},ot={"room-created":()=>l.createElement(s.TextSmall,null,"was created"),"room-deleted":()=>l.createElement(s.TextSmall,null,"was deleted"),"room-node-added":lt,"room-node-removed":rt,"room-user-added":lt,"room-user-removed":rt},it=e=>{var t;let{action:n,hosts:a=[],Netdata:r,user:o}=e;const i=ot[n],c=null===(t=a[0])||void 0===t?void 0:t.name;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Node"),l.createElement(Le,null,c),l.createElement(i,{room:r.room}),l.createElement(Ne,{user:null===o||void 0===o?void 0:o.name}))},ct=e=>{let{action:t,Netdata:n,user:a}=e;const r=ot[t];return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"User"),l.createElement(Le,null,Xe(a,"name")),l.createElement(r,{room:n.room}),l.createElement(Ne,{hide:!a.target,user:a.name}))};var st=e=>{let{action:t,Netdata:n,user:a}=e;const r=ot[t];return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Room"),l.createElement(Le,null,Je(n.room)),l.createElement(r,null),l.createElement(Ne,{user:a.name}))};const dt={"alert-node-transition":e=>{let{chart:t,hosts:n,alert:a,...r}=e;return n.map(((e,n)=>{let{id:o,name:i}=e;const c={...a,name:a.name[n],...a.current?{current:{...a.current,...a.current.status?{status:a.current.status[n]||a.current.status[0]}:{}}}:{}};return l.createElement(Pe,(0,h.Z)({key:o,chart:t,nodeId:o,nodeName:i,alert:c},r))}))},"node-created":at,"node-state-live":at,"node-state-stale":at,"node-state-offline":at,"node-removed":at,"node-deleted":at,"node-restored":at,"agent-connected":e=>{let{agentId:t}=e;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Agent with claim ID"),l.createElement(Le,null,t)," ",l.createElement(s.TextSmall,null,"has connected to Cloud"))},"agent-disconnected":e=>{let{agentId:t,reason:n}=e;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Agent with claim ID"),l.createElement(Le,null,t),l.createElement(s.TextSmall,null,"has disconnected from Cloud with reason: \u201c",n,"\u201d"))},"agent-authenticated":e=>{let{agentId:t}=e;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Agent with claim ID"),l.createElement(Le,null,t),l.createElement(s.TextSmall,null,"has successfully authenticated"))},"agent-authentication-failed":e=>{let{agentId:t}=e;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Agent with claim ID"),l.createElement(Le,null,t),l.createElement(s.TextSmall,null,"has failed to authenticate"))},"room-created":st,"room-deleted":st,"room-node-added":it,"room-node-removed":it,"room-user-added":ct,"room-user-removed":ct,"space-created":e=>{let{Netdata:t,user:n}=e;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"Space"),l.createElement(Le,null,t.space.name||t.space.id),l.createElement(s.TextSmall,null,"was created"),l.createElement(Ne,{user:n.name}))},"space-statistics":Ye,"space-user-added":e=>{let{Netdata:t,user:n}=e;const{name:a}=(null===t||void 0===t?void 0:t.inviter)||{};return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"User"),l.createElement(Le,null,Xe(n,"name")),l.createElement(s.TextSmall,null,"was added to this space"),a&&l.createElement(l.Fragment,null,l.createElement(s.TextSmall,null,"by invite of"),l.createElement(Le,null,a)))},"space-user-changed":e=>{var t;let{user:n}=e;if(!(null===(t=n.changes)||void 0===t||!t.roles)&&1===Object.keys(n.changes).length){const e=n.changes.roles.length>1,t=n.changes.roles.join(", ");return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"User ",e?"roles":"role"," for"),l.createElement(Le,null,Xe(n,"name")),l.createElement(s.TextSmall,null,e?"were":"was"," changed to"),l.createElement(Le,null,t),l.createElement(Ne,{hide:!n.target,user:n.name}))}return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"User"),l.createElement(Le,null,Xe(n,"name")),l.createElement(s.TextSmall,null,"was modified"))},"space-user-invited":e=>{let{user:t}=e;return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"User"),l.createElement(Le,null,Xe(t,"email")),l.createElement(s.TextSmall,null,"was invited to this space"),l.createElement(Ne,{user:t.name}))},"space-user-removed":e=>{let{user:t}=e;const{name:n}=t.target||{};return l.createElement(Ae,null,l.createElement(s.TextSmall,null,"User"),l.createElement(Le,null,Xe(t,"name")),l.createElement(s.TextSmall,null,"was removed from this space"),n&&l.createElement(Ne,{user:t.name}))},"space-user-uninvited":e=>{let{event:t,user:n}=e;return"space-invite-expired"===t.reason?l.createElement(Ae,null,l.createElement(s.TextSmall,null,"The invite for"),l.createElement(Le,null,Xe(n,"email")),l.createElement(s.TextSmall,null,"to this space has expired")):l.createElement(Ae,null,l.createElement(s.TextSmall,null,"User"),l.createElement(Le,null,Xe(n,"email")),l.createElement(s.TextSmall,null,"was uninvited from this space"),l.createElement(Ne,{hide:!n.target,user:n.name}))},"silencing-rule-created":qe,"silencing-rule-deleted":qe,"silencing-rule-changed":qe};var ut=e=>{let{data:t}=e;const{action:n,roomId:a,space:r}=t.source,o=(0,Ze.vu)(r.id,"slug"),i=(0,p.tE)(a,"slug"),c=dt[n];return c?l.createElement(c,(0,h.Z)({},t.source,{spaceSlug:o,roomSlug:i})):l.createElement(Ae,null,l.createElement(s.Text,null,"Event")," ",l.createElement(s.Text,{strong:!0},n)," ",l.createElement(s.Text,null,"emitted"))};const mt={bar:Ke,"bar-with-integer":Ke,duration:Ke,pill:Fe,number:Ie,string:Ie,feedTemplate:ut,datetime:e=>{let{value:t,...n}=e;const a=new Date(t),{localeTimeString:r,localeDateString:o}=(0,fe.rA)(),i=isNaN(a.valueOf())?"Missing date & time":"".concat(o(a,{long:!1})," ").concat(r(a,{secs:!0}));return l.createElement(Ie,(0,h.Z)({value:i},n))},value:Ie},gt={bar:Ke,pill:Fe,value:Ie,feedTemplate:ut};var ft=e=>{let{visualization:t,type:n,value:a,...r}=e;const o=gt[t]||mt[n]||gt.value;return l.createElement(o,(0,h.Z)({value:a,type:n},r))};const pt={sum:"sum",min:"min",max:"max",extent:"extent",mean:"mean",median:"median",unique:"unique",uniqueCount:"uniqueCount",count:"count"};const ht=(0,l.memo)(s.NetdataTable,((e,t)=>(0,be.ZP)(e,t,{keep:["columnVisibility","data","fnQuery","sortBy","virtualizeOptions"]}))),vt={cellStyles:{height:"46px"},headStyles:{height:"44px"},styles:{verticalAlign:"middle"}};var xt=(0,l.memo)((0,l.forwardRef)(((e,t)=>{let{"data-testid":n,paramsKey:a,refetch:r,onShowInfo:o}=e;const{columns:c,sortedColumns:d,sortColumn:u,sortDirection:m,columnVisibility:g,pinnedColumns:f,loading:h,totalSize:v,anchor:x,retentionWarning:E,groupByColumns:y}=(0,i.ZQ)(a),[b,C]=(0,l.useState)(""),S=F(a),T="feed"===a.extraKey,w=((e,t,n)=>{let{groupBy:a}=n;return(0,l.useMemo)((()=>e.reduce(((e,n)=>{const r=t[n],{name:o,sortable:i,sticky:c,units:d,max:u,maxValue:m,dummy:g,cellSize:f,valueOptions:p,summary:h,type:v,visualization:x,...E}=r;return g?e:[...e,{...E,id:n,accessor:n,cell:e=>{let{getValue:t,row:n}=e;const r=n.getCanExpand(),i=t(),c=pt[h]===pt.count||pt[h]===pt.uniqueCount||!pt[h];return l.createElement(ft,{description:o,data:n.original,maxValue:u||m.value,padding:n.depth>0?[0,0,0,2.5*n.depth]:[0],strong:r,value:r&&c?"".concat(i,"x"):i,tooltipValue:r&&c?"".concat(i," ").concat(1===i?"item":"items"," associated with ").concat(a," grouping"):i,valueOptions:c?{...p,transform:"none"}:p,type:v,visualization:x})},header:l.createElement(s.Flex,{column:!0},n,d&&l.createElement(s.TextMicro,null,"(",d,")")),enableSorting:i,aggregationFn:pt[h]||pt.count,...f,meta:{biggestCellIndexPerColumn:null===m||void 0===m?void 0:m.index,sticky:c,styles:{verticalAlign:"middle"},...n!==o?{tooltip:o}:{}}}]}),[])),[t,a])})(d,c,{...T?{}:{groupBy:b}}),I=(0,i.CE)(a),K=(0,p.UL)(),[Z,z]=(0,i.fg)({key:"sortColumn",...a}),[N,L]=(0,i.fg)({key:"sortDirection",...a}),[D,A]=(0,i.kU)({key:"query",...a}),M=(0,i.I_)({key:"columnVisibility",...a}),[,R]=(0,k.I0)(Z,{defaultValue:[],key:K,extraKey:"".concat(I,"RangeFilter")}),P=(0,l.useMemo)((()=>Z||u?[{id:Z||u,desc:"descending"===(N||m)}]:[]),[u,m,Z,N]),O=(0,l.useCallback)((e=>{const[t]=e(),n=(null===t||void 0===t?void 0:t.id)||n,a=null!==t&&void 0!==t&&t.desc?m||"descending":"ascending";z(n),L(a),Z!==n&&R([])}),[Z,R,u,m]),_=(0,l.useCallback)((e=>{M((t=>({...t,...e()})))}),[]),B=(0,l.useMemo)((()=>({left:f})),[f]),V=(0,l.useMemo)((()=>({overscan:10,hasNextPage:v>S.length,loading:h,loadMore:()=>{h||v<=S.length||r({anchor:x,merge:!0})},warning:E})),[S.length,h]),j=(0,l.useCallback)((e=>{let{data:t}=e;return o(t.json||t)}),[]);return l.createElement(ht,{groupByColumns:y,onClickRow:j,autoFixedColumns:!0,columnPinning:B,columnVisibility:g,data:S,dataColumns:w,dataGa:"functions",enableColumnPinning:!!f.length,enableColumnVisibility:!T,enableCustomSearch:!T,enablePinning:!T&&!!f.length,enableResize:!0,enableSorting:!T,globalFilter:T?null:D,onColumnVisibilityChange:_,onGlobalSearchChange:T?null:A,onGroupByChange:T?null:C,onSortingChange:T?null:O,sortBy:P,testPrefix:n,virtualizeOptions:V,meta:vt,ref:t})})),(()=>!0)),Et=n(18997),yt=n(4808),bt=n(50361),Ct=n.n(bt),St=n(38609),kt=n(81732),Tt=n(85672);const wt={minSize:Tt.bb.xs,maxSize:Tt.bb.xl},It={bar:{size:Tt.bb.xs},value:{minSize:Tt.bb.sm,size:Tt.bb.md},feedTemplate:{size:Tt.bb.xxl,minSize:Tt.bb.lg,maxSize:5e3},pill:{size:Tt.bb.md,minSize:Tt.bb.md}},Kt=(e,t,n)=>{const{defaultSortColumn:a,updateEvery:l,merge:r,groupBy:o,...i}=t,c=Ct()(r?(0,St.Z)(n.columns,t.columns):t.columns);let s={};const d=Object.keys(c).reduce(((e,t)=>{const n=c[t],{sticky:a,visible:l,index:r}=n;var o;return e.columnVisibility[t]=l,a&&e.pinnedColumns.push(t),n.valueOptions=n.valueOptions||{},n.cellSize=(o=n.visualization||n.type,n.uniqueKey?{minSize:Tt.bb.xs,maxSize:Tt.bb.md,size:Tt.bb.xs}:{...wt,...It[o]||It.xs}),"undefined"!==typeof r&&(s[r]=t),e}),{columnVisibility:{},pinnedColumns:[]}),u=t.data.map((e=>e.reduce(((e,t,n)=>{var a,l;const r=s[n];if(!r)return e;const o=c[r],i=isNaN(t)?(null===t||void 0===t?void 0:t.length)||0:t;"flexTemplate"!==o.type&&(!o.maxValue||i>o.maxValue.value)&&(o.maxValue={index:n,value:i});const d=(null===o||void 0===o||null===(a=o.range)||void 0===a?void 0:a.min)||t,u=(null===o||void 0===o||null===(l=o.range)||void 0===l?void 0:l.max)||o.max||t;return o.range={min:d<t?d:t,max:u>t?u:t},e[r]=t,e}),{})));e({...kt.Zn.table,...i,groupByColumns:o,data:r?(n.data||[]).concat(u):u,columns:r?(0,St.Z)(n.columns,c):c,updatedAt:(new Date).getTime(),updateEvery:l,sortedColumns:Object.values(s),sortColumn:a,sortDirection:a?c[a].sort:"descending",...d,loading:!1,loaded:!0})},Ft=(e,t)=>{const{data:n,type:a,updateEvery:l,...r}=t;e({...kt.Zn.default,...r,data:n,updateEvery:l,type:a,loading:!1,loaded:!0})},Zt={default:{fetch:yt.Ru,isEnabled:e=>{let{nodeIds:t,fn:n}=e;return!(null===t||void 0===t||!t.length)&&!!n}},feed:{fetch:yt.bj,isEnabled:e=>{let{roomId:t,fn:n}=e;return!!t&&!!n}}},zt=()=>{const{after:e,before:t}=(0,k.by)();return(0,l.useMemo)((()=>{if(e>0)return[{after:e,before:t},e,t];const n=Date.now();return[{after:n+1e3*e,before:n},e,t]}),[e,t])};var Nt=n(92501),Lt=n(26495),Dt=n(36337),At=n(19221),Mt=n(23148);var Rt=(0,T.cn)({key:"feedChart",default:{navigation:"pan"}});const Pt=(0,T.CG)({key:"feedChartState",get:e=>{let{key:t}=e;return e=>{let{get:n}=e;const a=n(Rt);return t?a[t]:a}},set:e=>{let{key:t}=e;return(e,n)=>{let{set:a}=e;a(Rt,(e=>t?{...e,[t]:n}:{...e,...n}))}}}),Ot=e=>(0,T.sJ)(Pt({key:e})),_t=e=>(0,T.Zl)(Pt({key:e}));n(47121);const Bt=(0,c.default)(s.Button).attrs((e=>{let{active:t}=e;return{flavour:"borderless",iconColor:t?"textDescription":"border",iconSize:"small",padding:[.5],small:!0}})).withConfig({displayName:"styled__Button",componentId:"sc-8s0lqd-0"})(["&&{background-color:",";height:20px;width:20px;&:hover{background-color:",";.button-icon__color{fill:",";}}}"],(e=>{let{theme:t,active:n}=e;return n?(0,s.getColor)("borderSecondary")({theme:t}):"initial"}),(e=>{let{theme:t}=e;return(0,s.getColor)("borderSecondary")({theme:t})}),(e=>{let{theme:t}=e;return(0,s.getColor)("textDescription")({theme:t})})),Vt=(0,c.default)(s.Flex).attrs({padding:[.5],gap:1,round:!0,border:{side:"all",color:"borderSecondary"}}).withConfig({displayName:"styled__Container",componentId:"sc-8s0lqd-1"})(["position:absolute;top:18px;right:8px;background:",";&:hover{background:",";}"],(0,s.getRgbColor)("elementBackground",.5),(0,s.getColor)("elementBackground")),jt=e=>{let{active:t,disabled:n,defaultColor:a="border"}=e;return t?"textDescription":n?"disabled":a};c.default.button.attrs((e=>{let{icon:t,hoverIndicator:n=!0,padding:a=0,...l}=e;return{...l,children:t,active:l.active||l["aria-expanded"],hoverIndicator:n,padding:a}})).withConfig({displayName:"styled__StyledButton",componentId:"sc-8s0lqd-2"})(["border:initial;padding:",";height:fit-content;line-height:0;background:",";cursor:pointer;svg{fill:",";stroke:",";}"," &:hover{",";svg{fill:",";stroke:",";}}"],(e=>{let{padding:t}=e;return t}),(e=>{let{theme:t,active:n}=e;return n?(0,s.getColor)("borderSecondary")({theme:t}):"initial"}),(e=>{let{active:t,disabled:n,theme:a,stroked:l}=e;return l?"none":(0,s.getColor)(jt({active:t,disabled:n}))({theme:a})}),(e=>{let{active:t,disabled:n,theme:a,stroked:l}=e;return l?(0,s.getColor)(jt({active:t,disabled:n}))({theme:a}):"none"}),(e=>{let{active:t,hoverIndicator:n}=e;return(t||n)&&"\n    border-radius: 4px;\n  "}),(e=>{let{theme:t,hoverIndicator:n,disabled:a}=e;return n&&!a&&"background: ".concat((0,s.getColor)("borderSecondary")({theme:t}),";")}),(e=>{let{theme:t,stroked:n,disabled:a}=e;return n?"none":(0,s.getColor)(jt({defaultColor:"textDescription",disabled:a}))({theme:t})}),(e=>{let{theme:t,stroked:n,disabled:a}=e;return n?(0,s.getColor)(jt({defaultColor:"textDescription",disabled:a}))({theme:t}):"none"}));var Ut=(0,l.forwardRef)(((e,t)=>{let{testIdPrefix:n,...a}=e;const[{after:r,before:o},i]=(0,k.I0)(),[c,s]=[Ot(d="navigation"),_t(d)];var d;const u=(0,l.useCallback)((e=>{let t=r,n=o;if(r<0){const e=Date.now();t=e+1e3*r,n=e}const a=e*Math.round((n-t)/4);i({after:t+a,before:n-a})}),[r,o]),m=r>0&&Math.abs(o-r)<2e3||-1===r;return l.createElement(Vt,(0,h.Z)({"data-testid":"chartToolbox","data-track":"chart-toolbox::hover-chart::".concat(n),"data-toolbox":"true",ref:t},a),l.createElement(Bt,{active:"pan"===c,"data-testid":"chartToolbox-pan","data-track":"chart-toolbox::pan-click::".concat(n),icon:"panTool",onClick:()=>s("pan"),title:"Pan"}),l.createElement(Bt,{active:"highlight"===c,"data-testid":"chartToolbox-highlight","data-track":"chart-toolbox::highlight-click::".concat(n),icon:"highlightArea",onClick:()=>s("highlight"),title:"Highlight"}),l.createElement(Bt,{active:"zoom"===c,"data-testid":"chartToolbox-zoom","data-track":"chart-toolbox::zoom-click::".concat(n),disabled:m,icon:"dragHorizontal",onClick:()=>{s("zoom")},title:"Select and zoom"}),l.createElement(Bt,{"data-testid":"chartToolbox-zoomIn","data-track":"chart-toolbox::zoom-in-click::".concat(n),disabled:m,icon:"zoomIn",onClick:()=>{u(1)},title:"Zoom in"}),l.createElement(Bt,{"data-testid":"chartToolbox-zoomOut","data-track":"chart-toolbox::zoom-out-click::".concat(n),icon:"zoomOut",onClick:()=>{u(-1)},title:"Zoom out"}),l.createElement(Bt,{"data-testid":"chartToolbox-zoomReset","data-track":"chart-toolbox::zoom-reset-click::".concat(n),disabled:-900===r&&0===o,icon:"zoomReset",onClick:()=>{i({after:-900,before:0})},title:"Zoom reset"}))}));const Ht={after:null,before:null};Mt.kL.register(Dt.Z,Mt.vn,Mt.ZL,Mt.uw,Mt.De,Mt.f$,Mt.FB,Mt.u,At.ZP);var Wt=e=>{var t,n;let{paramsKey:a,testIdPrefix:r}=e;const o=(0,l.useRef)(),d=(0,l.useContext)(c.ThemeContext),[m,g]=(0,k.I0)(),[f,p]=(0,l.useState)([]),[h,v]=(0,l.useState)(Ht),[x,E]=(0,l.useState)(!1),[y,b]=(0,l.useState)(!1),[C,S]=(0,l.useState)([]),[T,w]=(0,l.useState)(null),[I,K]=(0,l.useState)("second"),[F,,Z,z]=(0,u.Z)(!1),{aggregations:N}=(0,i.ZQ)(a),{navigation:L}=Ot(),{localeTimeString:D,localeDateString:A}=(0,fe.rA)(),[M]=zt(),R=M.before-M.after,P=(0,l.useMemo)((()=>{const e=Date.now();return{min:M.after-R,max:0===m.before?M.before:e<M.before+R?e:M.before+R}}),[M.after,M.before,m.before]),O=[{backgroundColor:(0,s.getColor)("primary")({theme:d}),borderWidth:0,data:f,label:"Histogram",maxBarThickness:50,minBarLength:0}];(0,l.useEffect)((()=>{var e,t;if(null===N||void 0===N||null===(e=N.event_histogram)||void 0===e||null===(t=e.hits)||void 0===t||!t.buckets)return;const n=N.event_histogram.hits.buckets.reduce(((e,t)=>{let{key:n,doc_count:a}=t;return{data:[...e.data,a],labels:[...e.labels,n]}}),{data:[],labels:[]}),a=(0,Ce.BZ)(m.after,m.before)||{};p(n.data),S(n.labels),w(null),K(a.unit)}),[null===N||void 0===N||null===(t=N.event_histogram)||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.buckets]);const _=(0,l.useMemo)((()=>({animation:!1,interaction:{axis:"x"},maintainAspectRatio:!1,plugins:{annotation:{annotations:{...h.after&&h.before?{annotation:{type:"box",backgroundColor:"rgba(128,128,128,0.3)",borderDash:[1,5,1,1],borderWidth:1,xMax:h.before,xMin:h.after,xScaleID:"x"}}:{}}},legend:{align:"start",display:!1,position:"bottom"},zoom:{limits:{x:P},pan:{enabled:"pan"===L&&!x,mode:"x",onPanStart:e=>{let{chart:t}=e;t.canvas.style.cursor="grabbing"},onPanComplete:e=>{let{chart:t}=e;t.canvas.style.cursor="default";const{min:n,max:a}=t.scales.x;w({min:Math.round(n),max:Math.round(a)}),g({after:Math.round(n),before:Math.round(a)}),t.update()},threshold:1},zoom:{drag:{enabled:"zoom"===L||x},mode:"x",onZoomStart:e=>{let{chart:t}=e;t.canvas.style.cursor="col-resize"},onZoomComplete:e=>{let{chart:t}=e;if("zoom"!==L&&!x)return;t.canvas.style.cursor="default";const{min:n,max:a}=t.scales.x;g({after:Math.round(n),before:Math.round(a)}),E(!1)}}}},responsive:!0,scales:{x:{type:"time",grid:{drawBorder:!0,drawOnChartArea:!1,drawTicks:!0,offset:!1},parsing:!1,ticks:{color:(0,s.getColor)("textLite")({theme:d}),font:{size:11},autoSkip:!0,maxTicksLimit:20,..."minute"===I&&R>=1e3*Tt.Kl?{callback:e=>{const t=A(e,{month:"2-digit",day:"2-digit",year:"numeric",long:!1,dateStyle:void 0}).split("/").reverse().slice(1).join("-"),n=D(e,{secs:!1});return"".concat(t," ").concat(n)}}:{}},time:{displayFormats:{week:"yyyy-MM-dd",day:"MM-dd",hour:"MM-dd HH:mm",minute:"HH:mm",second:"HH:mm:ss"},tooltipFormat:"yyyy-MM-dd HH:mm:ss",unit:I||"second"},...T?{min:T.min,max:T.max}:{}},y:{beginAtZero:!0,ticks:{precision:0,color:(0,s.getColor)("textLite")({theme:d}),font:{size:11}}}}})),[h,R,x,L,T,w,I,P]);if((0,l.useEffect)((()=>{const e=e=>{"Shift"===e.key&&(e.preventDefault(),E(!0))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]),!f.length)return null;return l.createElement(s.Flex,{position:"relative",height:{min:50},onMouseEnter:Z,onMouseLeave:z},F&&l.createElement(Ut,{testIdPrefix:r}),l.createElement(Lt.$Q,{data:{datasets:O,labels:C},onMouseDown:e=>{if(e.preventDefault(),"highlight"!==L)return;b(!0);const t=e.nativeEvent.offsetX||e.nativeEvent.layerX,n=o.current;n.canvas.style.cursor="crosshair",v({after:Math.round(n.scales.x.getValueForPixel(t)),before:null})},onMouseMove:e=>{if(e.preventDefault(),"highlight"!==L||!y)return;const t=e.nativeEvent.offsetX||e.nativeEvent.layerX,n=o.current;v((e=>({...e,before:Math.round(n.scales.x.getValueForPixel(t))})))},onMouseUp:e=>{e.preventDefault(),b(!1);const t=e.nativeEvent.offsetX||e.nativeEvent.layerX,n=o.current;n.canvas.style.cursor="default";h.after===Math.round(n.scales.x.getValueForPixel(t))?v(Ht):v(h)},options:_,ref:o}))};const Qt=e=>({label:e,value:e});var qt=e=>{let{paramsKey:t,initData:n,initFilter:a}=e;const{charts:r,loading:o}=(0,i.ZQ)(t),d=F(t),u=(0,l.useContext)(c.ThemeContext),m=Object.keys(r).map(Qt),g=S(t.extraKey,Qt),[f,p]=(0,l.useState)(n),[h,v]=(0,l.useState)(a),x=(0,i.CE)(t);(0,l.useEffect)((()=>{p(n)}),[n]),(0,l.useEffect)((()=>{v(a)}),[a]);const E=(0,l.useMemo)((()=>{if(!r[f])return{datasets:[],labels:[]};const e=r[f].columns,t=null===d||void 0===d?void 0:d.reduce(((t,n)=>{const a=n[h];return t[a]?{...t,[a]:e.reduce(((e,t)=>({...e,[t]:e[t]+n[t],sorter:e.sorter+n[t]})),t[a])}:{...t,[a]:e.reduce(((e,t,l)=>({...e,...0===l?{label:a,sorter:n[t]}:{},[t]:n[t],sorter:e.sorter?e.sorter+n[t]:n[t]})),{})}}),{}),n=Object.values(t).sort(((e,t)=>t.sorter-e.sorter)).slice(0,15).map((e=>{let{sorter:t,...n}=e;return{...n}}));return{datasets:r[f].columns.map(((e,t)=>({backgroundColor:Tt.vK[t],borderWidth:0,data:n.map((t=>t[e])),label:e,maxBarThickness:50,minBarLength:0}))),labels:n.map((e=>{let{label:t}=e;return t}))}}),[x,r,f,h,d]),y={animation:!1,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{boxWidth:4,boxHeight:20,title:{color:(0,s.getColor)("textLite")({theme:u})}}}},responsive:!0,scales:{x:{stacked:!0},y:{stacked:!0}}};return l.createElement(s.Flex,{column:!0,"data-testid":"functionsCharts",gap:3,width:"50%"},l.createElement(s.Flex,{alignItems:"center","data-testid":"functionsChart".concat(f,"-selects"),gap:2},l.createElement(s.Select,{"data-ga":"functions-chart-".concat(f,"::select-data::functions-view"),"data-testid":"functionsChart".concat(f,"-dataSelect"),isLoading:o,onChange:e=>{let{value:t}=e;return p(t)},options:m,styles:{size:"tiny",minWidth:120},value:{label:f,value:f}}),l.createElement(s.Text,{"data-testid":"functionsChart".concat(f,"-perLabel"),color:"textLite"},"per"),l.createElement(s.Select,{"data-ga":"functions-chart-".concat(h,"::select-filter::functions-view"),"data-testid":"functionsChart".concat(h,"-filterSelect"),isLoading:o,onChange:e=>{let{value:t}=e;return v(t)},options:g,styles:{size:"tiny",minWidth:120},value:{label:h,value:h}})),l.createElement(s.Flex,{position:"relative",height:{min:60},width:{min:"100%"}},l.createElement(Lt.$Q,{data:E,options:y})))};const Gt={extraKey:"fn"},Xt={fn:{Chart:e=>{let{margin:t,defaultCharts:n,...a}=e;return l.createElement(s.Flex,{gap:6,margin:t},n.map(((e,t)=>{let[n,r]=e;return l.createElement(qt,(0,h.Z)({key:t,initData:n,initFilter:r},a))})))},loadingMessage:"Loading function..."},feed:{Chart:Wt,loadingMessage:"Loading events..."}},Jt={table:xt},Yt=(0,l.memo)((e=>{let{paramsKey:t=Gt,testIdPrefix:n="functions",availableFns:r,availableFnsLoaded:o,hasError:c,...d}=e;const{Chart:u,loadingMessage:m}=Xt[t.extraKey]||Xt.fn,[g,f]=(0,i.Hv)(t),x=(0,k.c6)(t),{loaded:E,data:y,error:b,type:C,retentionWarning:S,defaultCharts:T}=(0,i.ZQ)(t),w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const[t]=e,n=(0,v.bV)(t,"name");return 1===e.length&&n?"on ".concat(n):"on your selected node"}(x);(0,l.useEffect)((()=>{null!==g&&void 0!==g&&g.length||null===r||void 0===r||!r.length||c||f([r[0]])}),[o,g]);const[I,K]=(0,ce.useHovered)({},[E]),F=(0,se.Z)();(0,l.useEffect)((()=>{F(K)}),[K]);const Z=((e,t,n)=>{const r=(0,Ze.th)(),o=(0,p.vf)(),c=(0,i.T2)(n),s=(0,i.e6)(n),[d,u]=(0,i.mO)(n),m=(0,l.useRef)();m.current=d;const g=e=>{let{data:t={}}=e;(a[t.type]||Ft)(u,t,m.current)},{fetch:f,isEnabled:h}=Zt[t]||Zt.default,[x,E,y]=zt(),b=(0,l.useRef)();b.current=x;const C=(0,p.UL)(),S=(0,k.by)(null,{key:C,extraKey:"".concat(t||n.extraKey,"Filters")}),T=(0,v.Xw)(e);return(0,Et.Z)((()=>({enabled:h({nodeIds:e,fn:t,roomId:C}),fetch:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f({roomId:C,spaceId:r,nodeIds:e,cloudNodeIds:T,fn:t,roomSlug:o,...S,...b.current,...n})},onStart:()=>u({loading:!0}),onFail:e=>{var t,n;null!==(t=e)&&void 0!==t&&null!==(n=t.response)&&void 0!==n&&n.data&&(e=e.response.data),u({error:e,loading:!1,loaded:!0})},onReceive:g,polling:c||!1,pollingOptions:{pollingInterval:1e3*(s||d.updateEvery),shouldPause:!0},force:!0})),[C,null===e||void 0===e?void 0:e.length,null===e||void 0===e?void 0:e[0],t,c,c&&s,"feed"===t&&S,E,y])})(x,g[0],t);if(!E||!o)return l.createElement(ne.Z,{title:m,"data-testid":"".concat(n,"Loading")});if(c)return l.createElement(Nt.NY,{title:"Functions couldn't be loaded",message:"We couldn't find any available functions."});if(b&&"canceled"!==b)return"ErrNodeResourceNotFound"===(null===b||void 0===b?void 0:b.errorMsgKey)?l.createElement(oe.Z,{message:"Please review your selection and try again.",title:"".concat("feed"===t.extraKey?"Events are":'Function "'.concat(g,' is"')," not available ").concat(w,".")}):l.createElement(Nt.NY,{title:"".concat("feed"===t.extraKey?"Events":"Functions"," couldn't be loaded"),message:"ErrForbidden"===(null===b||void 0===b?void 0:b.errorMsgKey)?"Forbidden":""});const z=Jt[C]||Jt.table;return l.createElement(s.Box,{overflow:{horizontal:"hidden",vertical:"auto"},column:!0,padding:[4,4,0],gap:2},l.createElement(ye,{nodeIds:x,onRefresh:Z,paramsKey:t}),l.createElement(u,{paramsKey:t,testIdPrefix:n,defaultCharts:T}),E&&null!==y&&void 0!==y&&y.length?l.createElement(z,(0,h.Z)({"data-testid":"".concat(n,"Component"),paramsKey:t,refetch:Z,ref:I},d)):l.createElement(s.Flex,{column:!0,justifyContent:"center",alignItems:"center",alignSelf:"center",margin:["feed"===t.extraKey?3:30,0,0],gap:3},l.createElement(s.H3,null,"No results to display"),l.createElement(s.Text,{color:"textDescription",textAlign:"center"},"Double-check your search or filters and dates and try again with different conditions"),S&&l.createElement(s.Text,{color:"text",textAlign:"center"},S)))}));var $t=Yt;const en={extraKey:"fn"};const tn={extraKey:"feed"};const nn={fn:{Component:e=>{let{paramsKey:t=en,hasError:n,...a}=e;const r=(0,k.H7)(t),[o,i]=(0,k.wT)(t),[c]=(0,v.M2)(r),s=le(t);return(0,l.useEffect)((()=>{null!==r&&void 0!==r&&r.length&&(s||null!==o&&void 0!==o&&o.length||!c||i([c]))}),[s,i,o]),c?n?l.createElement(oe.Z,{title:"Functions not supported yet",message:"Stay tuned..."}):l.createElement($t,(0,h.Z)({testIdPrefix:"fn",paramsKey:t},a)):l.createElement(ie,{paramsKey:t})},paramsKey:{extraKey:"fn"},loading:"Loading functions..."},feed:{Component:e=>{let{paramsKey:t=tn,...n}=e;return le(t),l.createElement($t,(0,h.Z)({testIdPrefix:"feed",paramsKey:t},n))},paramsKey:{extraKey:"feed"},loading:"Loading events..."}};var an=e=>{let{flavour:t}=e;const{Component:n,paramsKey:a,loading:c}=nn[t]||nn.fn,s=(0,o.zN)(),d=(0,o.fD)(),[u,m]=(0,l.useState)(),{loaded:g,value:f,hasError:p}=(0,i.KO)(a.extraKey);return d?s.length||"fn"!==t?l.createElement(r.Z,{"data-testid":"".concat(t,"Page"),margin:[0,0,8,0],rightBar:l.createElement(ee,{flavour:t,selectedRowData:u,setSelectedRowData:m,availableFns:f})},l.createElement(n,{testIdPrefix:t,paramsKey:a,onShowInfo:m,availableFnsLoaded:g,availableFns:f,hasError:p})):l.createElement(te.Z,null):l.createElement(ne.Z,{title:c})}}}]);
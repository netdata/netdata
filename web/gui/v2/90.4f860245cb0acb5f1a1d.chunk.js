!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="94379c58-02fc-4c03-a83c-aa155d1a1c97",e._sentryDebugIdIdentifier="sentry-dbid-94379c58-02fc-4c03-a83c-aa155d1a1c97")}catch(e){}}();var _global="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};_global.SENTRY_RELEASE={id:"67fcafa0e89723987481f6de299b5bd1fcd6618a"},(self.webpackChunkcloud_frontend=self.webpackChunkcloud_frontend||[]).push([[90],{16978:function(e,t,n){var a=n(87462),r=n(45987),o=n(67294),c=n(54576),i=n(70486),l=n(86954),s=n(20581),u=n(16374),d=n(1981),m=n(28138),f=n(18892),g=n(63076),p=n(65855),h=["width","height"],v=(0,o.forwardRef)((function(e,t){var n=e.width,c=e.height,i=(0,r.Z)(e,h);return o.createElement(l.ChartWrapper,{width:n,height:c},o.createElement(p.x1,(0,a.Z)({hasHeader:!1,hasFilters:!1,hasFooter:!1,width:n,height:c},i,{ref:t})))})),E=(0,i.default)(v,{tile:!0}),y={dygraph:p.ZP,easypiechart:m.ZP,gauge:u.ZP,number:f.ZP,groupBoxes:s.ZP,d3pie:d.default,bars:g.ZP},w=function(e){var t=(0,c.useChart)(),n=(0,o.useMemo)((function(){if(!t)return null;var e=t.getAttributes(),n=e.chartLibrary;return e.sparkline?E:y[n]}),[t]);return n?o.createElement(n,(0,a.Z)({},e,{chart:t})):null};t.Z=(0,c.withChartProvider)((0,o.memo)(w))},82210:function(e,t,n){var a=n(67294),r=n(71893),o=n(99113),c=n(5710),i=n(37503),l=(0,r.default)(o.Flex).withConfig({displayName:"restrictedContentMessage__StyledBox",componentId:"sc-wbsw81-0"})(["transform:translate(-50%,-50%);"]),s={node:"This node is locked so you can't see the Single Node dashboard.",alert:"This node is locked so you can't see the full alert details. ",dashboard:"This dashboard is locked so you can't see it."};t.Z=function(e){var t=e.flavour,n=void 0===t?"node":t;return a.createElement(l,{column:!0,width:"100%",gap:2,alignItems:"center",position:"absolute",top:"50%",left:"50%",padding:[4],round:2},a.createElement(o.TextBigger,null,s[n]||""),a.createElement(i.Z,null,a.createElement(o.TextBig,{color:"primary"},"Upgrade for no limitations!")),a.createElement(o.TextBig,null,"or"),a.createElement(c.Z,null,a.createElement(o.TextBig,{color:"primary"},"Change your active node selection to unlock it.")))}},54244:function(e,t,n){var a=n(67294),r=n(99113);t.Z=function(e){var t=e.flavour,n=e.icon,o=e.children;return a.createElement(r.Pill,{icon:n,textProps:{textTransform:"capitalize"},flavour:t},o)}},50709:function(e,t,n){n.d(t,{Z:function(){return d}});var a=n(29439),r=n(67294),o=n(99113),c=n(12008),i=(n(92222),n(74916),n(15306),n(26398)),l=n(91008),s=n(37518),u=n(12899),d=function(e){var t=e.alertId,n=(0,c.E5)(t),d=n.name,m=function(e){var t=(0,r.useState)(!0),n=(0,a.Z)(t,2),o=n[0],c=n[1],l="".concat("https://community.netdata.cloud/t","/").concat(null===e||void 0===e?void 0:e.replace(/[._]/g,"-"));return(0,r.useEffect)((function(){e&&i.Z.get(l).then((function(){return c(!1)})).catch((function(){return c(!0)}))}),[e]),[l,o]}(void 0===d?"unknown alert":d),f=(0,a.Z)(m,2),g=f[0],p=f[1],h=(0,s.UL)(),v=(0,u.R3)(),E=(0,a.Z)(v,2)[1],y=(0,r.useMemo)((function(){return{alignSelf:"start",onClick:function(){return E({roomId:h,alert:n})}}}),[g,p,E]);return r.createElement(l.Z,y,"Learn more about this alert",!p&&r.createElement(o.Icon,{name:"arrow_left",rotate:2,size:"small",margin:[0,0,-.75,1],color:"success"}))}},80854:function(e,t,n){var a=n(87462),r=n(45987),o=n(67294),c=n(99113),i=["iconName","iconSize","children"];t.Z=function(e){var t=e.iconName,n=e.iconSize,l=e.children,s=(0,r.Z)(e,i);return o.createElement(c.Flex,(0,a.Z)({gap:2,alignItems:"center"},s),o.createElement(c.Icon,(0,a.Z)({name:t,color:"textLite"},n&&{height:n,width:n})),o.createElement(c.Text,{strong:!0},l))}},29876:function(e,t,n){n.d(t,{Z:function(){return f}});var a=n(87462),r=n(45987),o=n(67294),c=n(99113),i=n(12008),l=(n(92222),n(89405)),s=n(50358),u=n(39840),d=function(e){var t=e.label,n=e.testid,a=e.status,r=e.value,i=e.when,d=e.units,m=(0,l.rA)(),f=m.localeTimeString,g=m.localeDateString,p=(0,o.useMemo)((function(){var e=new Date(1e3*i);return e&&"".concat(g(e,{long:!1})," ").concat(f(e,{secs:!0}))}),[i,g,f]),h=(0,u.pK)(r,d);return o.createElement(c.Flex,{gap:2,alignItems:"center"},o.createElement(c.Flex,{width:"100px"},o.createElement(c.TextSmall,null,t)),o.createElement(c.Flex,{gap:2,alignItems:"center"},o.createElement(c.TextSmall,{color:"text","data-testid":"".concat(n,"-dateTime")},p),o.createElement(s.Z,{loaded:!0,status:a,valueWithUnit:h,"data-testid":"".concat(n,"-value")})))},m=["alertId"],f=function(e){var t=e.alertId,n=(0,r.Z)(e,m),l=(0,i.E5)(t),s=l.fullyLoaded,u=void 0!==s&&s,f=l.units,g=l.lastStatusChangeValue,p=l.lastStatusChange,h=l.status,v=l.lastUpdated,E=l.value;l.prevStatus,l.prevValue,l.prevDuration;return u?o.createElement(c.Flex,(0,a.Z)({gap:2,column:!0,"data-testid":"alertValues"},n),v&&o.createElement(d,{label:"Latest",status:h,testid:"alertValues-latest",value:E,when:v,units:f}),p&&o.createElement(d,{label:"Triggered",status:h,testid:"alertValues-triggered",value:g,when:p,units:f})):null}},92253:function(e,t,n){var a=n(4942),r=(n(92222),n(47941),n(82526),n(57327),n(41539),n(88449),n(2490),n(59849),n(38880),n(15581),n(34514),n(54747),n(49337),n(33321),n(69070),n(67294)),o=n(16978),c=n(50308),i=n.n(c),l=n(99113),s=n(91128),u=n(78266),d=n(74059),m=n(37518),f=n(9058),g=n(22648),p=n(39840);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=function(e){return function(t){return"alert-modal::".concat(e.getAttribute("id"),"::").concat(t)}},y={width:"108px",height:"77px"};t.Z=function(e){var t=e.instance,n=e.context,a=e.isFormattedValueLoaded,c=e.nodeId,h=e.status,w=e.lastStatusChange,b=e.formattedLastStatusChangeValue,x=e.lastUpdated,k=e.spaceId,Z=e.roomId,S=e.setChartSelected,I=void 0===S?i():S,C=(0,d.th)();k=k||C;var T=(0,m.UL)();Z=Z||T;var O=(0,g.m)(),D=(0,f.e)(),N=(0,s.Z)();(0,r.useEffect)((function(){return N(),N}),[]);var P=(0,d.Q6)(),F=(0,r.useMemo)((function(){if(a){var e=D.makeChart({attributes:{nodeId:c,contextScope:[n],selectedInstances:t&&c?["".concat(t,"@").concat(c)]:[],id:t,roomId:Z,enabledResetRange:!1,overlays:{proceeded:{type:"proceeded"},alarm:{type:"alarm",status:h,value:b,when:w}},host:P?"".concat(window.envSettings.agentApiUrl,"/api/v2"):"".concat(window.envSettings.apiUrl,"/api/v3/spaces/").concat(k,"/rooms/").concat(Z),nodesScope:[c],toolboxElements:[],sparkline:O,hasToolbox:!O},makeTrack:E});return D.getRoot().appendChild(e),e}}),[t,a]);return(0,p.Wi)({lastUpdated:x,lastStatusChange:w},a),(0,r.useEffect)((function(){return I((function(e){return v(v({},e),F)})),function(){F&&F.destroy(),I(null)}}),[F]),r.createElement(l.Flex,{flex:!1,width:"100%",height:75},a&&F?r.createElement(o.Z,{"data-chartid":t,chart:F,hasHeader:!O,hasFooter:!O}):r.createElement(u.Z,{iconProps:y,title:"Loading chart..."}))}},63860:function(e,t,n){var a=n(87462),r=n(45987),o=(n(74916),n(15306),n(67294)),c=n(71893),i=n(99113),l=n(39840),s=["rawTime","secs","long","nowrap"],u=c.default.div.withConfig({displayName:"timeCell__TimeBox",componentId:"sc-1k785pi-0"})(["display:flex;flex-direction:column;align-items:start;justify-content:center;"]);t.Z=function(e){var t=e.rawTime,n=e.secs,c=e.long,d=e.nowrap,m=void 0!==d&&d,f=(0,r.Z)(e,s),g=(0,l.e8)({rawTime:t,secs:n,long:c}),p=g.timeAgo,h=g.formattedDate,v=void 0===h?"":h;return o.createElement(u,f,o.createElement(i.TextSmall,null,p),o.createElement(i.TextMicro,(0,a.Z)({color:"textLite"},m&&{whiteSpace:"nowrap"}),v?null===v||void 0===v?void 0:v.replace(/ /g," - "):""))}},32071:function(e,t,n){n.d(t,{Z:function(){return _}});var a=n(67294),r=n(99113),o=n(12008),c=n(57387),i=n(71893),l=i.default.div.withConfig({displayName:"styled__StyledAlertTypeIndicator",componentId:"sc-19nk935-0"})(["width:",";height:",";border-radius:",";background-color:",";"],(0,r.getSizeBy)(1),(0,r.getSizeBy)(1),(0,r.getSizeBy)(1),(function(e){var t=e.critical,n=e.theme;return(0,r.getColor)(t?"error":["yellow","sunglow"])({theme:n})})),s=i.default.a.withConfig({displayName:"styled__StyledLink",componentId:"sc-19nk935-1"})(["padding:",";text-decoration:none;color:",";&:visited{color:",";}&:hover{text-decoration:none;}"],(function(e){var t=e.padding;return null!==t&&void 0!==t?t:"0"}),(0,r.getColor)("success"),(0,r.getColor)("success")),u=n(82351),d=function(e){var t=e.title,n=e.value,o=e.testId,i=e.status;return n?a.createElement(a.Fragment,null,a.createElement(r.Flex,{justifyContent:"between"},a.createElement(r.Flex,{gap:1,alignItems:"center"},a.createElement(l,{critical:"critical"===i}),a.createElement(r.H6,{color:"textDescription"},t)),a.createElement(r.Flex,{gap:1,alignItems:"center"},a.createElement(r.TextSmall,{color:"textDescription"},"More details about"," ",a.createElement(r.TextSmall,{strong:!0,color:"textDescription"},"$this")," ","command"),a.createElement(u.Z,{content:"The $this value comes from the DB Lookup or the Calculation above",isBasic:!0,plain:!0},a.createElement(r.Flex,{margin:[-.5,0,0]},a.createElement(r.Icon,{name:"informationPress",color:"textLite",width:"16px",height:"16px"}))))),a.createElement(c.ZP,{"data-testid":o},n)):null},m=(n(92222),n(91058),n(12195)),f=n(61973),g=n(33511),p=function(e){if("string"===typeof e&&(e=parseInt(e,10)),0===e)return"now";var t=new Date;return e<0?(0,m.Z)((0,f.Z)(t,e),t,{addSuffix:!0}):(0,m.Z)((0,g.Z)(t,e),t,{addSuffix:!0})},h=function(e){var t=(0,o.E5)(e),n=t.instance,r=t.lookupAfter,c=t.lookupBefore,i=t.lookupDimensions,l=t.lookupMethod,s=t.lookupOptions;return(0,a.useMemo)((function(){return r?function(e){var t=e.lookupOptions,n=e.lookupDimensions,a=e.lookupMethod,r=e.lookupAfter,o=e.lookupBefore,c=e.instance,i="of all values";if(n){var l=n.split(","),s=l.length>1?"of the sum of dimensions":"of all values of dimension";i="".concat(s," ").concat(l.join(", "))}var u=t?", with options ".concat(t):"";return"".concat(a," ").concat(i," of chart ").concat(c,", starting ").concat(p(r+o)," and up to ").concat(p(o)).concat(u)}({lookupOptions:s,lookupDimensions:i,lookupMethod:l,lookupAfter:r,lookupBefore:c,instance:n}):""}),[r,n])},v=n(80854),E=function(e){var t=e.heading,n=e.value,o=e.testId;return n&&n.length?a.createElement(r.Flex,{column:!0,gap:3},t&&a.createElement(r.H6,{textTransform:"uppercase",color:"textDescription"},t),a.createElement(c.ZP,{"data-testid":o},n)):null},y=(0,a.memo)(E),w=n(25935),b=n(87462),x=function(e){var t=e.iconName,n=e.category,o=e.iconSize,c=void 0===o?"16px":o,i=e.value,l=e.testid;return i?a.createElement(r.Flex,{alignItems:"center",gap:1},a.createElement(r.Flex,{alignItems:"center",gap:1,basis:"100px"},a.createElement(r.Icon,(0,b.Z)({name:t,color:"textLite"},c&&{height:c,width:c})),a.createElement(r.TextSmall,{whiteSpace:"nowrap",color:"textDescription"},n,":")),a.createElement(r.TextSmall,{strong:!0,"data-testid":l},i)):null},k=function(e){var t=e.id,n=e.testid,c=(0,o.E5)(t),i=c.calculation,s=c.warning,u=c.critical,m=c.updateEvery,f=h(t),g=(0,a.useMemo)((function(){return(0,w.ZP)(i)}),[i]);return a.createElement(r.Flex,{column:!0,gap:4},a.createElement(v.Z,{iconName:"code"},"Configuration"),a.createElement(y,{heading:"DB lookup",value:f,testId:"".concat(n,"-lookup")}),a.createElement(y,{heading:"Calculation",value:g,testId:"".concat(n,"-calculation")}),a.createElement(r.H6,{textTransform:"uppercase",color:"textDescription"},"Severity Conditions"),a.createElement(r.Flex,{column:!0,gap:2},a.createElement(d,{title:"Warning when",value:s,testId:"".concat(n,"-warningWhen"),status:"warning"},a.createElement(l,{critical:!1})),a.createElement(d,{title:"Critical when",value:u,testId:"".concat(n,"-criticalWhen"),status:"critical"},a.createElement(l,{critical:!0}))),a.createElement(r.H6,{textTransform:"uppercase",color:"textDescription"},"Check"),a.createElement(x,{iconName:"clock_hollow",category:"Check every",value:"".concat(m," seconds"),testid:"".concat(n,"-checkEvery")}))},Z=(0,a.memo)(k),S=n(97945),I=n(80239),C=n(45987),T=n(54244),O=n(63860),D=n(50358),N=["isHighlighted","lastStatusChangeValue","lastStatusChange","units","status","nodeName"],P=function(e){var t=e.isHighlighted,n=e.lastStatusChangeValue,o=e.lastStatusChange,c=e.units,i=e.status,l=e.nodeName,s=(0,C.Z)(e,N);return a.createElement(r.Flex,(0,b.Z)({background:t&&"modalTabsBackground",border:{side:"all",color:"borderSecondary"},color:"textDescription",justifyContent:"between",padding:[4],round:!0},s),a.createElement(r.Flex,{column:!0,justifyContent:"between",gap:2},l&&a.createElement(r.Text,{strong:!0},l),a.createElement(O.Z,{rawTime:o,secs:!0,"data-testid":"nodeItem-lastStatusChange"})),a.createElement(r.Flex,{height:5,gap:2,alignItems:"center",alignSelf:"start"},a.createElement(u.Z,{content:"Triggered value",align:"bottom"},a.createElement(r.Box,null,a.createElement(D.Z,{loaded:!0,status:i,units:c,value:n,"data-testid":"nodeItem-alertValue"}))),a.createElement(T.Z,{flavour:i,icon:"alarm_bell","data-testid":"alertView-alertPill-value"},i)))},F=function(e){var t=e.children;return a.createElement(r.Flex,{gap:2,column:!0},t)},_=function(e){var t=e.id,n=e.nodeName,c=e.testid,i=void 0===c?"alertDetailsModal":c,l=(0,o.E5)(t),u=l.class,d=l.instanceName,m=l.component,f=l.family,g=l.nodeId,p=l.type,h=l.lastStatusChangeValue,E=l.lastStatusChange,y=l.units,w=l.status,b=l.notificationType,k=(0,S.iy)(g,"name");return a.createElement(r.Flex,{column:!0,gap:4},a.createElement(v.Z,{iconName:"information",margin:[0,0,0,-.5]},"Alert Info"),a.createElement(F,null,a.createElement(x,{iconName:"nodes_hollow",category:"Node",value:n||k,testid:"".concat(i,"-hostname")}),a.createElement(x,{iconName:"charts_view",category:"Instance",value:d,testid:"".concat(i,"-chartId")}),a.createElement(x,{iconName:"data_retention",category:"Type",value:p,testid:"".concat(i,"-type")}),a.createElement(x,{iconName:"last_week",category:"Hostname"}),a.createElement(x,{iconName:"metrics",category:"Component",value:m,testid:"".concat(i,"-component")}),a.createElement(x,{iconName:"applications_hollow",category:"Family",value:f,testid:"".concat(i,"-family")}),a.createElement(x,{iconName:"networkingStack",category:"Class",value:u,testid:"".concat(i,"-class")}),a.createElement(x,{iconName:"incident_manager",category:"Event ID",testid:"".concat(i,"-eventId")})),a.createElement(Z,{id:t,testid:i}),a.createElement(v.Z,{iconName:"nodes_hollow",iconSize:"20px"},"Instance Values - Node Instances"),a.createElement(r.Flex,{column:!0,gap:2},"agent"!==b&&a.createElement(r.Text,{color:"textDescription"},"A node may be claimed through multiple instances on the cloud (streaming through parent) and Netdata aggregates the alerts from all the instances and displays a single Active alert based on the highest severity, latest change."),a.createElement(P,{lastStatusChangeValue:h,lastStatusChange:E,units:y,status:w,nodeName:k,isHighlighted:!0})),a.createElement(v.Z,{iconName:"gear",iconSize:"20px"},"Edit Alert"),a.createElement(r.Text,{"data-testid":"".concat(i,"-edit-info")},"If you wish to edit and configure this alert, please:"),a.createElement(s,{href:I.UV,target:"_blank",padding:"0 4px 0 0","data-testid":"".concat(i,"-editAlertConfig-link"),"data-ga":"alert-modal::click-edit::alerts-view"},"Visit the documentation",a.createElement(r.Icon,{name:"arrow_left",rotate:2,size:"small",margin:[0,0,-.75,1],color:"success"})))}},50358:function(e,t,n){var a=n(87462),r=n(45987),o=(n(92222),n(67294)),c=n(99113),i=n(45771),l=["loaded","status","units","value","valueWithUnit"],s={critical:{background:"errorSemi",border:{side:"all",color:"error"},color:"error"},warning:{background:"warningSemi",border:{side:"all",color:"warning"},color:"warning"},cleared:{background:"successSemi",border:{side:"all",color:"success"},color:"success"},default:{background:"generic",border:{side:"all",color:"border"},color:"text"}};t.Z=function(e){var t=e.loaded,n=e.status,u=e.units,d=e.value,m=e.valueWithUnit,f=(0,r.Z)(e,l),g=s[n]||s.default,p=g.background,h=g.border,v=g.color,E=(0,o.useMemo)((function(){if(m)return m;if(void 0===d)return"-";var e=(0,i.J)(d);return"".concat(e," ").concat(u||"-")}),[d,m,u]);return o.createElement(c.Flex,(0,a.Z)({background:p,border:h,padding:[.5,2],round:9,width:{min:10},justifyContent:"center"},f),o.createElement(c.TextSmall,{color:v,strong:!0,whiteSpace:"nowrap",truncate:!0},t?E:"-"))}},12899:function(e,t,n){n.d(t,{gN:function(){return S},R3:function(){return w},TA:function(){return y},Nu:function(){return b},zi:function(){return Z},m5:function(){return k}});var a=n(93433),r=n(4942),o=n(29439),c=(n(92222),n(69826),n(41539),n(31672),n(2490),n(59461),n(21249),n(57640),n(9924),n(57327),n(88449),n(59849),n(47941),n(82526),n(38880),n(15581),n(34514),n(54747),n(49337),n(33321),n(69070),n(67294)),i=n(4480),l=n(26398),s=n(66152),u=n(74059),d=n(37518),m=(0,i.cn)({key:"assistantAlert",default:null}),f=(0,i.cn)({key:"assistantAlertsAtom",default:[]}),g=(0,i.cn)({key:"assistantChatAtom",default:{open:!1,messages:[]}}),p=n(28721);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=(0,i.CG)({key:"assistantAlertSelector",get:function(e){var t=e.space,n=e.room,a=e.alert,r=e.node,o=e.chart;return function(){return function(e){var t=e.space,n=e.room,a=e.alert,r=e.node,o=e.chart;return l.Z.post("/api/v1/troubleshoot",{space:t,room:n,alarm:a,node:r,chart:o})}({space:t,room:n,alert:a,node:r||"dummy-node-id",chart:o||"dummy-chart-id"})}},cachePolicy_UNSTABLE:{eviction:"most-recent"}}),y=function(e){var t,n=e.alert,a=e.node,r=e.chart,o=(0,u.th)(),c=(0,d.UL)(),l=(0,i.$P)(E({space:o,room:c,alert:n,node:a,chart:r}));return{loaded:"loading"!==l.state,value:null===(t=l.contents)||void 0===t?void 0:t.data,hasError:"hasError"===l.state}},w=function(){return(0,i.FV)(m)},b=function(){return(0,i.FV)(f)},x=function(){return(0,i.FV)(g)},k=function(){var e=x(),t=(0,o.Z)(e,2),n=t[0],a=t[1],r=(0,c.useCallback)((function(){return a((function(e){return v(v({},e),{},{open:!0})}))}),[a]),i=(0,c.useCallback)((function(){return a((function(e){return v(v({},e),{},{open:!1})}))}),[a]);return[null===n||void 0===n?void 0:n.open,r,i]},Z=function(){var e=x(),t=(0,o.Z)(e,2),n=t[0],r=t[1],i=(0,c.useCallback)((function(e){return r((function(t){return v(v({},t),{},{messages:[].concat((0,a.Z)(t.messages),[e])})}))}),[r]),l=(0,c.useCallback)((function(){r((function(e){return v(v({},e),{},{messages:[]})}))}),[r]),s=(0,c.useMemo)((function(){return n.open&&!!n.messages.find((function(e){return!!e.pending}))}),[n]);return{messages:null===n||void 0===n?void 0:n.messages,pending:s,addMessage:i,clear:l}},S=function(){var e=function(){var e=Z().addMessage;return(0,c.useCallback)((function(t){var n=(0,p.Z)();return e({id:n,type:"question",value:t}),n}),[e])}(),t=function(){var e=Z().addMessage;return(0,c.useCallback)((function(t){var n=t.questionId,a=t.pending,r=t.answer;return e({id:(0,p.Z)(),questionId:n,type:"answer",value:r,pending:a})}),[e])}(),n=function(){var e=x(),t=(0,o.Z)(e,2)[1];return(0,c.useCallback)((function(e){var n=e.questionId,a=e.value,r=e.additionalInfo,o=e.error;t((function(e){return v(v({},e),{},{messages:e.messages.map((function(e){return e.questionId==n?v(v({},e),{},{pending:!1,value:a,additionalInfo:r,error:o}):e}))})}))}),[])}(),a=(0,c.useCallback)((function(a){var r,o=e(a);t({questionId:o,pending:!0}),(r=a,l.Z.post("/api/v1/chat",{messages:[{role:"user",content:r}]},{transform:function(e){return(0,s.k5)(e)}})).then((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).data,t=void 0===e?{}:e,a=t.session.messages,r=t.additionalInfo,c=(a||[]).filter((function(e){return"assistant"==e.role})),i=c.length?c[c.length-1]:null;null!==i&&void 0!==i&&i.content?n({questionId:o,value:i.content,additionalInfo:r}):n({questionId:o,error:"Something went wrong"})})).catch((function(e){n({questionId:o,error:e.message||"Something went wrong"})}))}),[e,n]);return a}}}]);
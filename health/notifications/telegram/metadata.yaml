# yamllint disable rule:line-length
---
- id: 'notify-telegram'
  meta:
    name: 'Telegram'
    link: 'https://telegram.org/'
    categories:
      - notify.agent
    icon_filename: 'telegram.png'
  keywords:
    - Telegram
  overview:
    notification_description: |
      Send notifications to Telegram using Netdata's Agent alert notification feature, which supports dozens of endpoints, user roles, and more.
    notification_limitations: ''
  setup:
    prerequisites:
      list:
        - title: ''
          description: |
            - A bot token. To get one, contact the [@BotFather](https://t.me/BotFather) bot and send the command `/newbot` and follow the instructions. Start a conversation with your bot or invite it into a group where you want it to send messages.
            - The chat ID for every chat you want to send messages to. Contact the [@myidbot](https://t.me/myidbot) bot and send the `/getid` command to get your personal chat ID or invite it into a group and use the `/getgroupid` command to get the group chat ID. Group IDs start with a hyphen, supergroup IDs start with `-100`.
            - Alternatively, you can get the chat ID directly from the bot API. Send your bot a command in the chat you want to use, then check `https://api.telegram.org/bot{YourBotToken}/getUpdates`, eg. `https://api.telegram.org/bot111122223:7OpFlFFRzRBbrUUmIjj5HF9Ox2pYJZy5/getUpdates`
            - Terminal access to the Agent you wish to configure
    configuration:
      file:
        name: 'health_alarm_notify.conf'
      options:
        description: 'The following options can be defined for this notification'
        folding:
          title: 'Config Options'
          enabled: true
        list:
          - name: 'SEND_TELEGRAM'
            default_value: 'YES'
            description: "Set `SEND_TELEGRAM` to YES"
            required: true
          - name: 'TELEGRAM_BOT_TOKEN'
            default_value: ''
            description: "set `TELEGRAM_BOT_TOKEN` to your bot token."
            required: true
          - name: 'DEFAULT_RECIPIENT_TELEGRAM'
            default_value: ''
            description: "Set `DEFAULT_RECIPIENT_TELEGRAM` to the chat ID you want the alert notifications to be sent to. You can define multiple chat IDs like this: 49999333322 -1009999222255."
            required: true
            detailed_description: >
              All roles will default to this variable if left unconfigured.

              The `DEFAULT_RECIPIENT_CUSTOM` can be edited in the following entries at the bottom of the same file:

              ```
              role_recipients_telegram[sysadmin]="49999333324"
              role_recipients_telegram[domainadmin]="49999333389"
              role_recipients_telegram[dba]="-1009999222255"
              role_recipients_telegram[webmaster]="-1009999222255 49999333389"
              role_recipients_telegram[proxyadmin]="49999333344"
              role_recipients_telegram[sitemgr]="49999333876"
              ```
      examples:
        folding:
          enabled: true
          title: ''
        list:
          - name: 'Basic Configuration'
            folding:
              enabled: false
            description: ''
            config: |
              #------------------------------------------------------------------------------
              # telegram (telegram.org) global notification options

              SEND_TELEGRAM="YES"
              TELEGRAM_BOT_TOKEN="111122223:7OpFlFFRzRBbrUUmIjj5HF9Ox2pYJZy5"
              DEFAULT_RECIPIENT_TELEGRAM="-100233335555"

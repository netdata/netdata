# When an oom kill event happens, notifies user
template: apps_oomkill
      os: linux
families: *
      on: apps.oomkills  
  lookup: sum -10s foreach *
   units: calls
   every: 10s
    warn: $this != 0
    info: An application raised an OOMkill.

# IP retransmit
# When 2% of packages are lost it is possible host
# is having network problems
   alarm: retransmit_tcp_error
      os: linux
      on: ip.tcp_retransmit  
  lookup: sum -10m
   units: percentage
    calc: ($ip.tcp_functions.tcp_sendmsg == 0) ? 0 : ($retransmitted/$ip.tcp_functions.tcp_sendmsg) * 100
   every: 1m
    warn: $this >= 2
    info: more than 2% of the packages have been retransmitted

#
#  Silent Alerts
#

# Check if a process either could not create
# a process or a thread.
template: task_error
families: *
      os: linux
      on: apps.task_error  
  lookup: sum -10s foreach *
   units: calls
   every: 10s
    warn: $this > 1
    info: Number of processes and threads not created
      to: silent
